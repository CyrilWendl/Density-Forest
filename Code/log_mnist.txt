[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 2417730819040107175
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 10921197568
locality {
  bus_id: 1
  links {
  }
}
incarnation: 10649137639396217443
physical_device_desc: "device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:02:00.0, compute capability: 6.1"
]
(array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9], dtype=uint8), array([5923, 6742, 5958, 6131, 5842, 5421, 5918, 6265, 5851, 5949]))
6
(array([0, 1, 2, 3, 4, 5, 6, 7, 8], dtype=uint8), array([5923, 6742, 5958, 6131, 5842, 5421, 6265, 5851, 5949]))
x_train shape: (54082, 28, 28, 1)
54082 train samples
9042 test samples
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_1 (Conv2D)            (None, 26, 26, 32)        320       
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 24, 24, 64)        18496     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 12, 12, 64)        0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 12, 12, 64)        0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 9216)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 128)               1179776   
_________________________________________________________________
dropout_2 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 9)                 1161      
=================================================================
Total params: 1,199,753
Trainable params: 1,199,753
Non-trainable params: 0
_________________________________________________________________
None
Train on 54082 samples, validate on 9042 samples
Epoch 1/5

  128/54082 [..............................] - ETA: 25:59 - loss: 2.2354 - acc: 0.0625
  768/54082 [..............................] - ETA: 4:20 - loss: 1.9708 - acc: 0.3138 
 1536/54082 [..............................] - ETA: 2:10 - loss: 1.6799 - acc: 0.4284
 2048/54082 [>.............................] - ETA: 1:38 - loss: 1.5049 - acc: 0.4888
 2432/54082 [>.............................] - ETA: 1:23 - loss: 1.4231 - acc: 0.5206
 3072/54082 [>.............................] - ETA: 1:06 - loss: 1.2828 - acc: 0.5693
 3584/54082 [>.............................] - ETA: 56s - loss: 1.2098 - acc: 0.5957 
 4224/54082 [=>............................] - ETA: 48s - loss: 1.1233 - acc: 0.6278
 5120/54082 [=>............................] - ETA: 39s - loss: 1.0023 - acc: 0.6713
 5888/54082 [==>...........................] - ETA: 34s - loss: 0.9322 - acc: 0.6962
 6656/54082 [==>...........................] - ETA: 30s - loss: 0.8718 - acc: 0.7168
 7424/54082 [===>..........................] - ETA: 27s - loss: 0.8297 - acc: 0.7310
 8192/54082 [===>..........................] - ETA: 24s - loss: 0.7874 - acc: 0.7454
 8960/54082 [===>..........................] - ETA: 22s - loss: 0.7525 - acc: 0.7566
 9728/54082 [====>.........................] - ETA: 20s - loss: 0.7148 - acc: 0.7693
10496/54082 [====>.........................] - ETA: 18s - loss: 0.6825 - acc: 0.7796
11264/54082 [=====>........................] - ETA: 17s - loss: 0.6530 - acc: 0.7892
12032/54082 [=====>........................] - ETA: 16s - loss: 0.6311 - acc: 0.7970
12800/54082 [======>.......................] - ETA: 15s - loss: 0.6087 - acc: 0.8045
13568/54082 [======>.......................] - ETA: 14s - loss: 0.5884 - acc: 0.8115
14336/54082 [======>.......................] - ETA: 13s - loss: 0.5723 - acc: 0.8169
15104/54082 [=======>......................] - ETA: 12s - loss: 0.5550 - acc: 0.8228
15872/54082 [=======>......................] - ETA: 11s - loss: 0.5384 - acc: 0.8283
16640/54082 [========>.....................] - ETA: 11s - loss: 0.5242 - acc: 0.8331
17408/54082 [========>.....................] - ETA: 10s - loss: 0.5116 - acc: 0.8372
18176/54082 [=========>....................] - ETA: 9s - loss: 0.4978 - acc: 0.8419 
18944/54082 [=========>....................] - ETA: 9s - loss: 0.4868 - acc: 0.8453
19712/54082 [=========>....................] - ETA: 8s - loss: 0.4761 - acc: 0.8491
20608/54082 [==========>...................] - ETA: 8s - loss: 0.4632 - acc: 0.8537
21504/54082 [==========>...................] - ETA: 7s - loss: 0.4514 - acc: 0.8571
22400/54082 [===========>..................] - ETA: 7s - loss: 0.4405 - acc: 0.8609
23296/54082 [===========>..................] - ETA: 7s - loss: 0.4299 - acc: 0.8643
24192/54082 [============>.................] - ETA: 6s - loss: 0.4231 - acc: 0.8666
25088/54082 [============>.................] - ETA: 6s - loss: 0.4134 - acc: 0.8699
25984/54082 [=============>................] - ETA: 5s - loss: 0.4042 - acc: 0.8728
26880/54082 [=============>................] - ETA: 5s - loss: 0.3967 - acc: 0.8752
27776/54082 [==============>...............] - ETA: 5s - loss: 0.3890 - acc: 0.8777
28672/54082 [==============>...............] - ETA: 5s - loss: 0.3813 - acc: 0.8800
29568/54082 [===============>..............] - ETA: 4s - loss: 0.3745 - acc: 0.8822
30464/54082 [===============>..............] - ETA: 4s - loss: 0.3680 - acc: 0.8842
31360/54082 [================>.............] - ETA: 4s - loss: 0.3627 - acc: 0.8863
32256/54082 [================>.............] - ETA: 4s - loss: 0.3565 - acc: 0.8881
33024/54082 [=================>............] - ETA: 3s - loss: 0.3517 - acc: 0.8896
33920/54082 [=================>............] - ETA: 3s - loss: 0.3461 - acc: 0.8915
34816/54082 [==================>...........] - ETA: 3s - loss: 0.3409 - acc: 0.8932
35712/54082 [==================>...........] - ETA: 3s - loss: 0.3366 - acc: 0.8945
36608/54082 [===================>..........] - ETA: 2s - loss: 0.3318 - acc: 0.8961
37504/54082 [===================>..........] - ETA: 2s - loss: 0.3267 - acc: 0.8977
38400/54082 [====================>.........] - ETA: 2s - loss: 0.3221 - acc: 0.8994
39296/54082 [====================>.........] - ETA: 2s - loss: 0.3177 - acc: 0.9007
40192/54082 [=====================>........] - ETA: 2s - loss: 0.3143 - acc: 0.9019
41088/54082 [=====================>........] - ETA: 2s - loss: 0.3098 - acc: 0.9035
41984/54082 [======================>.......] - ETA: 1s - loss: 0.3065 - acc: 0.9046
42880/54082 [======================>.......] - ETA: 1s - loss: 0.3032 - acc: 0.9057
43776/54082 [=======================>......] - ETA: 1s - loss: 0.2993 - acc: 0.9068
44672/54082 [=======================>......] - ETA: 1s - loss: 0.2952 - acc: 0.9081
45568/54082 [========================>.....] - ETA: 1s - loss: 0.2915 - acc: 0.9093
46464/54082 [========================>.....] - ETA: 1s - loss: 0.2883 - acc: 0.9104
47360/54082 [=========================>....] - ETA: 0s - loss: 0.2853 - acc: 0.9112
48128/54082 [=========================>....] - ETA: 0s - loss: 0.2825 - acc: 0.9122
49024/54082 [==========================>...] - ETA: 0s - loss: 0.2794 - acc: 0.9132
49920/54082 [==========================>...] - ETA: 0s - loss: 0.2767 - acc: 0.9140
50816/54082 [===========================>..] - ETA: 0s - loss: 0.2738 - acc: 0.9149
51712/54082 [===========================>..] - ETA: 0s - loss: 0.2712 - acc: 0.9157
52608/54082 [============================>.] - ETA: 0s - loss: 0.2687 - acc: 0.9164
53504/54082 [============================>.] - ETA: 0s - loss: 0.2660 - acc: 0.9174
54082/54082 [==============================] - 8s 140us/step - loss: 0.2642 - acc: 0.9180 - val_loss: 0.0589 - val_acc: 0.9810
Epoch 2/5

  128/54082 [..............................] - ETA: 4s - loss: 0.0808 - acc: 0.9766
  896/54082 [..............................] - ETA: 3s - loss: 0.1072 - acc: 0.9643
 1664/54082 [..............................] - ETA: 3s - loss: 0.0955 - acc: 0.9694
 2432/54082 [>.............................] - ETA: 3s - loss: 0.0910 - acc: 0.9712
 3200/54082 [>.............................] - ETA: 3s - loss: 0.0922 - acc: 0.9719
 3968/54082 [=>............................] - ETA: 3s - loss: 0.0933 - acc: 0.9715
 4736/54082 [=>............................] - ETA: 3s - loss: 0.0975 - acc: 0.9717
 5504/54082 [==>...........................] - ETA: 3s - loss: 0.0951 - acc: 0.9718
 6272/54082 [==>...........................] - ETA: 3s - loss: 0.1000 - acc: 0.9703
 7040/54082 [==>...........................] - ETA: 3s - loss: 0.1021 - acc: 0.9702
 7808/54082 [===>..........................] - ETA: 3s - loss: 0.1015 - acc: 0.9704
 8576/54082 [===>..........................] - ETA: 3s - loss: 0.1008 - acc: 0.9706
 9344/54082 [====>.........................] - ETA: 3s - loss: 0.0974 - acc: 0.9713
10112/54082 [====>.........................] - ETA: 3s - loss: 0.0977 - acc: 0.9711
10880/54082 [=====>........................] - ETA: 2s - loss: 0.0962 - acc: 0.9711
11648/54082 [=====>........................] - ETA: 2s - loss: 0.0960 - acc: 0.9712
12416/54082 [=====>........................] - ETA: 2s - loss: 0.0950 - acc: 0.9715
13184/54082 [======>.......................] - ETA: 2s - loss: 0.0959 - acc: 0.9710
13952/54082 [======>.......................] - ETA: 2s - loss: 0.0950 - acc: 0.9711
14720/54082 [=======>......................] - ETA: 2s - loss: 0.0962 - acc: 0.9707
15488/54082 [=======>......................] - ETA: 2s - loss: 0.0956 - acc: 0.9712
16256/54082 [========>.....................] - ETA: 2s - loss: 0.0961 - acc: 0.9710
17024/54082 [========>.....................] - ETA: 2s - loss: 0.0955 - acc: 0.9713
17792/54082 [========>.....................] - ETA: 2s - loss: 0.0961 - acc: 0.9708
18560/54082 [=========>....................] - ETA: 2s - loss: 0.0955 - acc: 0.9710
19328/54082 [=========>....................] - ETA: 2s - loss: 0.0950 - acc: 0.9709
20096/54082 [==========>...................] - ETA: 2s - loss: 0.0946 - acc: 0.9708
20864/54082 [==========>...................] - ETA: 2s - loss: 0.0956 - acc: 0.9707
21632/54082 [==========>...................] - ETA: 2s - loss: 0.0946 - acc: 0.9709
22400/54082 [===========>..................] - ETA: 2s - loss: 0.0933 - acc: 0.9714
23168/54082 [===========>..................] - ETA: 2s - loss: 0.0930 - acc: 0.9715
23936/54082 [============>.................] - ETA: 2s - loss: 0.0923 - acc: 0.9717
24704/54082 [============>.................] - ETA: 2s - loss: 0.0912 - acc: 0.9719
25472/54082 [=============>................] - ETA: 1s - loss: 0.0906 - acc: 0.9722
26240/54082 [=============>................] - ETA: 1s - loss: 0.0908 - acc: 0.9723
27008/54082 [=============>................] - ETA: 1s - loss: 0.0906 - acc: 0.9724
27776/54082 [==============>...............] - ETA: 1s - loss: 0.0902 - acc: 0.9726
28544/54082 [==============>...............] - ETA: 1s - loss: 0.0895 - acc: 0.9727
29312/54082 [===============>..............] - ETA: 1s - loss: 0.0896 - acc: 0.9726
30080/54082 [===============>..............] - ETA: 1s - loss: 0.0897 - acc: 0.9724
30848/54082 [================>.............] - ETA: 1s - loss: 0.0895 - acc: 0.9726
31744/54082 [================>.............] - ETA: 1s - loss: 0.0890 - acc: 0.9727
32640/54082 [=================>............] - ETA: 1s - loss: 0.0890 - acc: 0.9728
33536/54082 [=================>............] - ETA: 1s - loss: 0.0890 - acc: 0.9729
34432/54082 [==================>...........] - ETA: 1s - loss: 0.0881 - acc: 0.9730
35328/54082 [==================>...........] - ETA: 1s - loss: 0.0879 - acc: 0.9733
36224/54082 [===================>..........] - ETA: 1s - loss: 0.0882 - acc: 0.9732
37120/54082 [===================>..........] - ETA: 1s - loss: 0.0880 - acc: 0.9733
38016/54082 [====================>.........] - ETA: 1s - loss: 0.0877 - acc: 0.9734
38912/54082 [====================>.........] - ETA: 1s - loss: 0.0877 - acc: 0.9734
39808/54082 [=====================>........] - ETA: 0s - loss: 0.0881 - acc: 0.9732
40704/54082 [=====================>........] - ETA: 0s - loss: 0.0874 - acc: 0.9733
41600/54082 [======================>.......] - ETA: 0s - loss: 0.0876 - acc: 0.9734
42496/54082 [======================>.......] - ETA: 0s - loss: 0.0878 - acc: 0.9734
43392/54082 [=======================>......] - ETA: 0s - loss: 0.0874 - acc: 0.9735
44288/54082 [=======================>......] - ETA: 0s - loss: 0.0869 - acc: 0.9736
45056/54082 [=======================>......] - ETA: 0s - loss: 0.0869 - acc: 0.9735
45952/54082 [========================>.....] - ETA: 0s - loss: 0.0864 - acc: 0.9737
46848/54082 [========================>.....] - ETA: 0s - loss: 0.0869 - acc: 0.9736
47744/54082 [=========================>....] - ETA: 0s - loss: 0.0864 - acc: 0.9737
48512/54082 [=========================>....] - ETA: 0s - loss: 0.0864 - acc: 0.9738
49408/54082 [==========================>...] - ETA: 0s - loss: 0.0859 - acc: 0.9739
50304/54082 [==========================>...] - ETA: 0s - loss: 0.0861 - acc: 0.9738
51200/54082 [===========================>..] - ETA: 0s - loss: 0.0858 - acc: 0.9738
52096/54082 [===========================>..] - ETA: 0s - loss: 0.0856 - acc: 0.9740
52992/54082 [============================>.] - ETA: 0s - loss: 0.0853 - acc: 0.9741
53888/54082 [============================>.] - ETA: 0s - loss: 0.0858 - acc: 0.9740
54082/54082 [==============================] - 4s 69us/step - loss: 0.0859 - acc: 0.9741 - val_loss: 0.0392 - val_acc: 0.9853
Epoch 3/5

  128/54082 [..............................] - ETA: 4s - loss: 0.0650 - acc: 0.9766
 1024/54082 [..............................] - ETA: 3s - loss: 0.0586 - acc: 0.9814
 1920/54082 [>.............................] - ETA: 3s - loss: 0.0670 - acc: 0.9792
 2816/54082 [>.............................] - ETA: 3s - loss: 0.0653 - acc: 0.9794
 3456/54082 [>.............................] - ETA: 3s - loss: 0.0639 - acc: 0.9803
 4352/54082 [=>............................] - ETA: 3s - loss: 0.0658 - acc: 0.9798
 5248/54082 [=>............................] - ETA: 3s - loss: 0.0649 - acc: 0.9804
 6144/54082 [==>...........................] - ETA: 3s - loss: 0.0628 - acc: 0.9806
 6912/54082 [==>...........................] - ETA: 3s - loss: 0.0643 - acc: 0.9806
 7552/54082 [===>..........................] - ETA: 3s - loss: 0.0641 - acc: 0.9805
 8192/54082 [===>..........................] - ETA: 3s - loss: 0.0641 - acc: 0.9808
 8960/54082 [===>..........................] - ETA: 3s - loss: 0.0641 - acc: 0.9810
 9856/54082 [====>.........................] - ETA: 2s - loss: 0.0649 - acc: 0.9806
10752/54082 [====>.........................] - ETA: 2s - loss: 0.0643 - acc: 0.9807
11520/54082 [=====>........................] - ETA: 2s - loss: 0.0653 - acc: 0.9804
12416/54082 [=====>........................] - ETA: 2s - loss: 0.0668 - acc: 0.9798
13312/54082 [======>.......................] - ETA: 2s - loss: 0.0672 - acc: 0.9797
14208/54082 [======>.......................] - ETA: 2s - loss: 0.0679 - acc: 0.9794
15104/54082 [=======>......................] - ETA: 2s - loss: 0.0688 - acc: 0.9792
16000/54082 [=======>......................] - ETA: 2s - loss: 0.0686 - acc: 0.9793
16896/54082 [========>.....................] - ETA: 2s - loss: 0.0682 - acc: 0.9793
17536/54082 [========>.....................] - ETA: 2s - loss: 0.0681 - acc: 0.9795
18176/54082 [=========>....................] - ETA: 2s - loss: 0.0673 - acc: 0.9797
18816/54082 [=========>....................] - ETA: 2s - loss: 0.0665 - acc: 0.9799
19584/54082 [=========>....................] - ETA: 2s - loss: 0.0667 - acc: 0.9800
20480/54082 [==========>...................] - ETA: 2s - loss: 0.0667 - acc: 0.9801
21376/54082 [==========>...................] - ETA: 2s - loss: 0.0674 - acc: 0.9800
22144/54082 [===========>..................] - ETA: 2s - loss: 0.0670 - acc: 0.9802
23040/54082 [===========>..................] - ETA: 2s - loss: 0.0675 - acc: 0.9802
23936/54082 [============>.................] - ETA: 2s - loss: 0.0673 - acc: 0.9804
24832/54082 [============>.................] - ETA: 1s - loss: 0.0672 - acc: 0.9800
25728/54082 [=============>................] - ETA: 1s - loss: 0.0680 - acc: 0.9799
26624/54082 [=============>................] - ETA: 1s - loss: 0.0679 - acc: 0.9801
27136/54082 [==============>...............] - ETA: 1s - loss: 0.0673 - acc: 0.9804
27776/54082 [==============>...............] - ETA: 1s - loss: 0.0676 - acc: 0.9805
28416/54082 [==============>...............] - ETA: 1s - loss: 0.0671 - acc: 0.9805
29056/54082 [===============>..............] - ETA: 1s - loss: 0.0668 - acc: 0.9805
29824/54082 [===============>..............] - ETA: 1s - loss: 0.0668 - acc: 0.9804
30720/54082 [================>.............] - ETA: 1s - loss: 0.0671 - acc: 0.9803
31616/54082 [================>.............] - ETA: 1s - loss: 0.0667 - acc: 0.9803
32384/54082 [================>.............] - ETA: 1s - loss: 0.0666 - acc: 0.9802
33152/54082 [=================>............] - ETA: 1s - loss: 0.0671 - acc: 0.9803
34048/54082 [=================>............] - ETA: 1s - loss: 0.0670 - acc: 0.9804
34944/54082 [==================>...........] - ETA: 1s - loss: 0.0669 - acc: 0.9803
35584/54082 [==================>...........] - ETA: 1s - loss: 0.0668 - acc: 0.9803
36096/54082 [===================>..........] - ETA: 1s - loss: 0.0667 - acc: 0.9802
36736/54082 [===================>..........] - ETA: 1s - loss: 0.0666 - acc: 0.9803
37248/54082 [===================>..........] - ETA: 1s - loss: 0.0666 - acc: 0.9803
37888/54082 [====================>.........] - ETA: 1s - loss: 0.0663 - acc: 0.9804
38656/54082 [====================>.........] - ETA: 1s - loss: 0.0671 - acc: 0.9802
39552/54082 [====================>.........] - ETA: 1s - loss: 0.0669 - acc: 0.9802
40320/54082 [=====================>........] - ETA: 0s - loss: 0.0665 - acc: 0.9803
41088/54082 [=====================>........] - ETA: 0s - loss: 0.0664 - acc: 0.9803
41856/54082 [======================>.......] - ETA: 0s - loss: 0.0663 - acc: 0.9803
42624/54082 [======================>.......] - ETA: 0s - loss: 0.0665 - acc: 0.9802
43392/54082 [=======================>......] - ETA: 0s - loss: 0.0664 - acc: 0.9803
44160/54082 [=======================>......] - ETA: 0s - loss: 0.0662 - acc: 0.9802
44928/54082 [=======================>......] - ETA: 0s - loss: 0.0659 - acc: 0.9803
45696/54082 [========================>.....] - ETA: 0s - loss: 0.0660 - acc: 0.9803
46464/54082 [========================>.....] - ETA: 0s - loss: 0.0662 - acc: 0.9802
47232/54082 [=========================>....] - ETA: 0s - loss: 0.0660 - acc: 0.9803
48000/54082 [=========================>....] - ETA: 0s - loss: 0.0658 - acc: 0.9804
48768/54082 [==========================>...] - ETA: 0s - loss: 0.0659 - acc: 0.9803
49536/54082 [==========================>...] - ETA: 0s - loss: 0.0657 - acc: 0.9804
50304/54082 [==========================>...] - ETA: 0s - loss: 0.0658 - acc: 0.9804
51072/54082 [===========================>..] - ETA: 0s - loss: 0.0657 - acc: 0.9804
51840/54082 [===========================>..] - ETA: 0s - loss: 0.0657 - acc: 0.9804
52608/54082 [============================>.] - ETA: 0s - loss: 0.0653 - acc: 0.9805
53376/54082 [============================>.] - ETA: 0s - loss: 0.0653 - acc: 0.9805
54082/54082 [==============================] - 4s 75us/step - loss: 0.0651 - acc: 0.9806 - val_loss: 0.0313 - val_acc: 0.9898
Epoch 4/5

  128/54082 [..............................] - ETA: 4s - loss: 0.0470 - acc: 0.9922
  896/54082 [..............................] - ETA: 3s - loss: 0.0490 - acc: 0.9855
 1664/54082 [..............................] - ETA: 3s - loss: 0.0474 - acc: 0.9862
 2432/54082 [>.............................] - ETA: 3s - loss: 0.0437 - acc: 0.9873
 3200/54082 [>.............................] - ETA: 3s - loss: 0.0486 - acc: 0.9862
 3968/54082 [=>............................] - ETA: 3s - loss: 0.0516 - acc: 0.9851
 4736/54082 [=>............................] - ETA: 3s - loss: 0.0501 - acc: 0.9854
 5504/54082 [==>...........................] - ETA: 3s - loss: 0.0484 - acc: 0.9855
 6272/54082 [==>...........................] - ETA: 3s - loss: 0.0478 - acc: 0.9857
 7040/54082 [==>...........................] - ETA: 3s - loss: 0.0483 - acc: 0.9858
 7808/54082 [===>..........................] - ETA: 3s - loss: 0.0498 - acc: 0.9857
 8576/54082 [===>..........................] - ETA: 3s - loss: 0.0483 - acc: 0.9864
 9344/54082 [====>.........................] - ETA: 3s - loss: 0.0487 - acc: 0.9862
10112/54082 [====>.........................] - ETA: 3s - loss: 0.0488 - acc: 0.9859
10880/54082 [=====>........................] - ETA: 3s - loss: 0.0483 - acc: 0.9854
11648/54082 [=====>........................] - ETA: 3s - loss: 0.0489 - acc: 0.9851
12416/54082 [=====>........................] - ETA: 2s - loss: 0.0477 - acc: 0.9855
13184/54082 [======>.......................] - ETA: 2s - loss: 0.0463 - acc: 0.9858
14080/54082 [======>.......................] - ETA: 2s - loss: 0.0489 - acc: 0.9852
14848/54082 [=======>......................] - ETA: 2s - loss: 0.0481 - acc: 0.9855
15616/54082 [=======>......................] - ETA: 2s - loss: 0.0493 - acc: 0.9851
16384/54082 [========>.....................] - ETA: 2s - loss: 0.0499 - acc: 0.9849
17280/54082 [========>.....................] - ETA: 2s - loss: 0.0506 - acc: 0.9845
18176/54082 [=========>....................] - ETA: 2s - loss: 0.0497 - acc: 0.9846
18944/54082 [=========>....................] - ETA: 2s - loss: 0.0495 - acc: 0.9847
19712/54082 [=========>....................] - ETA: 2s - loss: 0.0505 - acc: 0.9844
20480/54082 [==========>...................] - ETA: 2s - loss: 0.0506 - acc: 0.9843
21248/54082 [==========>...................] - ETA: 2s - loss: 0.0506 - acc: 0.9843
22016/54082 [===========>..................] - ETA: 2s - loss: 0.0506 - acc: 0.9843
22784/54082 [===========>..................] - ETA: 2s - loss: 0.0512 - acc: 0.9841
23552/54082 [============>.................] - ETA: 2s - loss: 0.0516 - acc: 0.9841
24320/54082 [============>.................] - ETA: 2s - loss: 0.0518 - acc: 0.9840
25088/54082 [============>.................] - ETA: 2s - loss: 0.0522 - acc: 0.9841
25856/54082 [=============>................] - ETA: 1s - loss: 0.0523 - acc: 0.9840
26624/54082 [=============>................] - ETA: 1s - loss: 0.0522 - acc: 0.9842
27392/54082 [==============>...............] - ETA: 1s - loss: 0.0533 - acc: 0.9839
28160/54082 [==============>...............] - ETA: 1s - loss: 0.0531 - acc: 0.9841
28928/54082 [===============>..............] - ETA: 1s - loss: 0.0532 - acc: 0.9840
29696/54082 [===============>..............] - ETA: 1s - loss: 0.0528 - acc: 0.9841
30464/54082 [===============>..............] - ETA: 1s - loss: 0.0527 - acc: 0.9842
31232/54082 [================>.............] - ETA: 1s - loss: 0.0525 - acc: 0.9841
32000/54082 [================>.............] - ETA: 1s - loss: 0.0522 - acc: 0.9842
32768/54082 [=================>............] - ETA: 1s - loss: 0.0522 - acc: 0.9843
33536/54082 [=================>............] - ETA: 1s - loss: 0.0527 - acc: 0.9840
34304/54082 [==================>...........] - ETA: 1s - loss: 0.0532 - acc: 0.9839
35072/54082 [==================>...........] - ETA: 1s - loss: 0.0529 - acc: 0.9840
35840/54082 [==================>...........] - ETA: 1s - loss: 0.0530 - acc: 0.9840
36608/54082 [===================>..........] - ETA: 1s - loss: 0.0529 - acc: 0.9839
37376/54082 [===================>..........] - ETA: 1s - loss: 0.0526 - acc: 0.9841
38144/54082 [====================>.........] - ETA: 1s - loss: 0.0531 - acc: 0.9839
38912/54082 [====================>.........] - ETA: 1s - loss: 0.0529 - acc: 0.9840
39680/54082 [=====================>........] - ETA: 1s - loss: 0.0528 - acc: 0.9840
40448/54082 [=====================>........] - ETA: 0s - loss: 0.0528 - acc: 0.9839
41216/54082 [=====================>........] - ETA: 0s - loss: 0.0533 - acc: 0.9838
41984/54082 [======================>.......] - ETA: 0s - loss: 0.0537 - acc: 0.9836
42752/54082 [======================>.......] - ETA: 0s - loss: 0.0536 - acc: 0.9836
43520/54082 [=======================>......] - ETA: 0s - loss: 0.0534 - acc: 0.9838
44288/54082 [=======================>......] - ETA: 0s - loss: 0.0536 - acc: 0.9837
45056/54082 [=======================>......] - ETA: 0s - loss: 0.0539 - acc: 0.9835
45824/54082 [========================>.....] - ETA: 0s - loss: 0.0538 - acc: 0.9835
46592/54082 [========================>.....] - ETA: 0s - loss: 0.0539 - acc: 0.9835
47360/54082 [=========================>....] - ETA: 0s - loss: 0.0534 - acc: 0.9836
48128/54082 [=========================>....] - ETA: 0s - loss: 0.0536 - acc: 0.9836
48896/54082 [==========================>...] - ETA: 0s - loss: 0.0537 - acc: 0.9837
49664/54082 [==========================>...] - ETA: 0s - loss: 0.0539 - acc: 0.9837
50432/54082 [==========================>...] - ETA: 0s - loss: 0.0540 - acc: 0.9836
51200/54082 [===========================>..] - ETA: 0s - loss: 0.0539 - acc: 0.9837
51968/54082 [===========================>..] - ETA: 0s - loss: 0.0538 - acc: 0.9837
52736/54082 [============================>.] - ETA: 0s - loss: 0.0536 - acc: 0.9838
53504/54082 [============================>.] - ETA: 0s - loss: 0.0536 - acc: 0.9838
54082/54082 [==============================] - 4s 75us/step - loss: 0.0537 - acc: 0.9838 - val_loss: 0.0299 - val_acc: 0.9893
Epoch 5/5

  128/54082 [..............................] - ETA: 5s - loss: 0.0087 - acc: 1.0000
  896/54082 [..............................] - ETA: 4s - loss: 0.0323 - acc: 0.9933
 1664/54082 [..............................] - ETA: 3s - loss: 0.0447 - acc: 0.9874
 2432/54082 [>.............................] - ETA: 3s - loss: 0.0421 - acc: 0.9877
 3200/54082 [>.............................] - ETA: 3s - loss: 0.0415 - acc: 0.9884
 3968/54082 [=>............................] - ETA: 3s - loss: 0.0414 - acc: 0.9882
 4736/54082 [=>............................] - ETA: 3s - loss: 0.0440 - acc: 0.9869
 5504/54082 [==>...........................] - ETA: 3s - loss: 0.0411 - acc: 0.9880
 6272/54082 [==>...........................] - ETA: 3s - loss: 0.0410 - acc: 0.9880
 7040/54082 [==>...........................] - ETA: 3s - loss: 0.0429 - acc: 0.9876
 7808/54082 [===>..........................] - ETA: 3s - loss: 0.0424 - acc: 0.9873
 8576/54082 [===>..........................] - ETA: 3s - loss: 0.0426 - acc: 0.9875
 9344/54082 [====>.........................] - ETA: 3s - loss: 0.0436 - acc: 0.9873
10112/54082 [====>.........................] - ETA: 3s - loss: 0.0440 - acc: 0.9875
10880/54082 [=====>........................] - ETA: 3s - loss: 0.0431 - acc: 0.9877
11648/54082 [=====>........................] - ETA: 3s - loss: 0.0429 - acc: 0.9874
12416/54082 [=====>........................] - ETA: 3s - loss: 0.0426 - acc: 0.9875
13184/54082 [======>.......................] - ETA: 2s - loss: 0.0433 - acc: 0.9873
13952/54082 [======>.......................] - ETA: 2s - loss: 0.0433 - acc: 0.9875
14720/54082 [=======>......................] - ETA: 2s - loss: 0.0432 - acc: 0.9873
15360/54082 [=======>......................] - ETA: 2s - loss: 0.0438 - acc: 0.9871
16128/54082 [=======>......................] - ETA: 2s - loss: 0.0435 - acc: 0.9872
16896/54082 [========>.....................] - ETA: 2s - loss: 0.0439 - acc: 0.9869
17664/54082 [========>.....................] - ETA: 2s - loss: 0.0436 - acc: 0.9869
18432/54082 [=========>....................] - ETA: 2s - loss: 0.0427 - acc: 0.9871
19072/54082 [=========>....................] - ETA: 2s - loss: 0.0437 - acc: 0.9868
19840/54082 [==========>...................] - ETA: 2s - loss: 0.0430 - acc: 0.9870
20608/54082 [==========>...................] - ETA: 2s - loss: 0.0421 - acc: 0.9872
21376/54082 [==========>...................] - ETA: 2s - loss: 0.0433 - acc: 0.9868
22144/54082 [===========>..................] - ETA: 2s - loss: 0.0433 - acc: 0.9868
22912/54082 [===========>..................] - ETA: 2s - loss: 0.0430 - acc: 0.9869
23680/54082 [============>.................] - ETA: 2s - loss: 0.0426 - acc: 0.9869
24448/54082 [============>.................] - ETA: 2s - loss: 0.0428 - acc: 0.9867
25216/54082 [============>.................] - ETA: 2s - loss: 0.0424 - acc: 0.9868
26112/54082 [=============>................] - ETA: 2s - loss: 0.0429 - acc: 0.9867
26880/54082 [=============>................] - ETA: 1s - loss: 0.0428 - acc: 0.9867
27648/54082 [==============>...............] - ETA: 1s - loss: 0.0424 - acc: 0.9868
28544/54082 [==============>...............] - ETA: 1s - loss: 0.0427 - acc: 0.9867
29184/54082 [===============>..............] - ETA: 1s - loss: 0.0422 - acc: 0.9868
29952/54082 [===============>..............] - ETA: 1s - loss: 0.0427 - acc: 0.9869
30848/54082 [================>.............] - ETA: 1s - loss: 0.0428 - acc: 0.9869
31744/54082 [================>.............] - ETA: 1s - loss: 0.0425 - acc: 0.9871
32512/54082 [=================>............] - ETA: 1s - loss: 0.0431 - acc: 0.9869
33024/54082 [=================>............] - ETA: 1s - loss: 0.0433 - acc: 0.9868
33664/54082 [=================>............] - ETA: 1s - loss: 0.0434 - acc: 0.9868
34432/54082 [==================>...........] - ETA: 1s - loss: 0.0430 - acc: 0.9868
35200/54082 [==================>...........] - ETA: 1s - loss: 0.0425 - acc: 0.9870
35968/54082 [==================>...........] - ETA: 1s - loss: 0.0422 - acc: 0.9870
36736/54082 [===================>..........] - ETA: 1s - loss: 0.0417 - acc: 0.9872
37504/54082 [===================>..........] - ETA: 1s - loss: 0.0418 - acc: 0.9872
38272/54082 [====================>.........] - ETA: 1s - loss: 0.0419 - acc: 0.9871
39168/54082 [====================>.........] - ETA: 1s - loss: 0.0421 - acc: 0.9872
39936/54082 [=====================>........] - ETA: 1s - loss: 0.0420 - acc: 0.9872
40704/54082 [=====================>........] - ETA: 0s - loss: 0.0422 - acc: 0.9871
41472/54082 [======================>.......] - ETA: 0s - loss: 0.0425 - acc: 0.9870
42240/54082 [======================>.......] - ETA: 0s - loss: 0.0428 - acc: 0.9870
42880/54082 [======================>.......] - ETA: 0s - loss: 0.0430 - acc: 0.9869
43392/54082 [=======================>......] - ETA: 0s - loss: 0.0433 - acc: 0.9867
44032/54082 [=======================>......] - ETA: 0s - loss: 0.0434 - acc: 0.9868
44800/54082 [=======================>......] - ETA: 0s - loss: 0.0431 - acc: 0.9869
45696/54082 [========================>.....] - ETA: 0s - loss: 0.0431 - acc: 0.9869
46592/54082 [========================>.....] - ETA: 0s - loss: 0.0432 - acc: 0.9869
47360/54082 [=========================>....] - ETA: 0s - loss: 0.0432 - acc: 0.9869
48128/54082 [=========================>....] - ETA: 0s - loss: 0.0435 - acc: 0.9869
48896/54082 [==========================>...] - ETA: 0s - loss: 0.0434 - acc: 0.9869
49792/54082 [==========================>...] - ETA: 0s - loss: 0.0436 - acc: 0.9869
50560/54082 [===========================>..] - ETA: 0s - loss: 0.0434 - acc: 0.9869
51328/54082 [===========================>..] - ETA: 0s - loss: 0.0430 - acc: 0.9870
52096/54082 [===========================>..] - ETA: 0s - loss: 0.0428 - acc: 0.9871
52736/54082 [============================>.] - ETA: 0s - loss: 0.0427 - acc: 0.9871
53504/54082 [============================>.] - ETA: 0s - loss: 0.0429 - acc: 0.9870
54016/54082 [============================>.] - ETA: 0s - loss: 0.0430 - acc: 0.9870
54082/54082 [==============================] - 4s 78us/step - loss: 0.0430 - acc: 0.9871 - val_loss: 0.0302 - val_acc: 0.9888
Test loss: 0.03015948323542914
Test accuracy: 0.988829904888299
Mean accuracy: 64.78 %
Std accuracy: 31.68 %
22.96% of all predictions made with an accuracy higher than 0.95%
Mean accuracy: 98.50 %
Std accuracy: 8.72 %
95.62 % of all predictions made with an accuracy higher than 0.95%
(1, 1, 24, 24, 64)
(958, 128)
(60000, 128)
(54082, 128)
(10000, 128)
[t-SNE] Computing 91 nearest neighbors...
[t-SNE] Indexed 10000 samples in 0.016s...
[t-SNE] Computed neighbors for 10000 samples in 1.097s...
[t-SNE] Computed conditional probabilities for sample 1000 / 10000
[t-SNE] Computed conditional probabilities for sample 2000 / 10000
[t-SNE] Computed conditional probabilities for sample 3000 / 10000
[t-SNE] Computed conditional probabilities for sample 4000 / 10000
[t-SNE] Computed conditional probabilities for sample 5000 / 10000
[t-SNE] Computed conditional probabilities for sample 6000 / 10000
[t-SNE] Computed conditional probabilities for sample 7000 / 10000
[t-SNE] Computed conditional probabilities for sample 8000 / 10000
[t-SNE] Computed conditional probabilities for sample 9000 / 10000
[t-SNE] Computed conditional probabilities for sample 10000 / 10000
[t-SNE] Mean sigma: 1.495596
[t-SNE] KL divergence after 250 iterations with early exaggeration: 73.013206
[t-SNE] Error after 300 iterations: 2.668395
Trying parameters: {'max_iter': 10000, 'n_components': 4}
Trying parameters: {'max_iter': 10000, 'n_components': 5}
Trying parameters: {'max_iter': 10000, 'n_components': 8}
Trying parameters: {'max_iter': 10000, 'n_components': 9}
Trying parameters: {'max_iter': 10000, 'n_components': 10}
PR AUC: 0.63, AUROC: 0.96
Trying parameters: {'degree': 1, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.0001}
Trying parameters: {'degree': 7, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.001}
Trying parameters: {'degree': 11, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.1}
Trying parameters: {'degree': 4, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.01}
Trying parameters: {'degree': 9, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.001}
Trying parameters: {'degree': 12, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.1}
Trying parameters: {'degree': 1, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.5}
Trying parameters: {'degree': 2, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.3}
Trying parameters: {'degree': 1, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.001}
Trying parameters: {'degree': 7, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.01}
Trying parameters: {'degree': 12, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.0001}
Trying parameters: {'degree': 12, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.01}
Trying parameters: {'degree': 13, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.1}
Trying parameters: {'degree': 6, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.1}
Trying parameters: {'degree': 14, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.0001}
Trying parameters: {'degree': 14, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.01}
Trying parameters: {'degree': 15, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.01}
Trying parameters: {'degree': 3, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.3}
Trying parameters: {'degree': 6, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.3}
Trying parameters: {'degree': 5, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.3}
Trying parameters: {'degree': 1, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.3}
Trying parameters: {'degree': 15, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.0001}
Trying parameters: {'degree': 16, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.001}
Trying parameters: {'degree': 16, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.1}
Trying parameters: {'degree': 5, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.01}
Trying parameters: {'degree': 10, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.01}
Trying parameters: {'degree': 11, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.3}
Trying parameters: {'degree': 6, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.0001}
Trying parameters: {'degree': 8, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.3}
Trying parameters: {'degree': 4, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.5}
Trying parameters: {'degree': 4, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.3}
Trying parameters: {'degree': 5, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.5}
Trying parameters: {'degree': 6, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.5}
Trying parameters: {'degree': 3, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.5}
Trying parameters: {'degree': 4, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.1}
Trying parameters: {'degree': 13, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.0001}
Trying parameters: {'degree': 14, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.1}
Trying parameters: {'kernel': 'rbf', 'nu': 0.001}
Trying parameters: {'degree': 8, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.0001}
Trying parameters: {'degree': 9, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.01}
Trying parameters: {'degree': 13, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.001}
Trying parameters: {'degree': 15, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.1}
Trying parameters: {'degree': 7, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.0001}
Trying parameters: {'degree': 11, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.001}
Trying parameters: {'degree': 13, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.3}
Trying parameters: {'degree': 2, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.001}
Trying parameters: {'degree': 7, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.5}
Trying parameters: {'degree': 2, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.0001}
Trying parameters: {'degree': 7, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.3}
Trying parameters: {'degree': 6, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.001}
Trying parameters: {'degree': 9, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.3}
Trying parameters: {'degree': 2, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.5}
Trying parameters: {'degree': 5, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.0001}
Trying parameters: {'degree': 10, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.001}
Trying parameters: {'degree': 10, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.3}
Trying parameters: {'degree': 4, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.0001}
Trying parameters: {'degree': 8, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.01}
Trying parameters: {'degree': 11, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.01}
Trying parameters: {'degree': 14, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.001}
Trying parameters: {'degree': 14, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.3}
Trying parameters: {'degree': 4, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.001}
Trying parameters: {'degree': 8, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.5}
Trying parameters: {'degree': 2, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.01}
Trying parameters: {'degree': 8, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.001}
Trying parameters: {'degree': 9, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.5}
Trying parameters: {'degree': 6, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.01}
Trying parameters: {'degree': 10, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.5}
Trying parameters: {'degree': 3, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.1}
Trying parameters: {'degree': 13, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.01}
Trying parameters: {'degree': 15, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.3}
Trying parameters: {'degree': 3, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.001}
Trying parameters: {'degree': 9, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.0001}
Trying parameters: {'degree': 11, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.5}
Trying parameters: {'degree': 5, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.001}
Trying parameters: {'degree': 11, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.0001}
Trying parameters: {'degree': 12, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.5}
Trying parameters: {'degree': 3, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.0001}
Trying parameters: {'degree': 8, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.1}
Trying parameters: {'degree': 15, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.001}
Trying parameters: {'degree': 16, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.3}
Trying parameters: {'degree': 5, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.1}
Trying parameters: {'degree': 13, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.5}
Trying parameters: {'degree': 2, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.1}
Trying parameters: {'degree': 12, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.001}
Trying parameters: {'degree': 12, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.3}
Trying parameters: {'degree': 1, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.01}
Trying parameters: {'degree': 7, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.1}
Trying parameters: {'degree': 14, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.5}
Trying parameters: {'kernel': 'rbf', 'nu': 0.5}
Trying parameters: {'degree': 1, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.1}
Trying parameters: {'degree': 9, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.1}
Trying parameters: {'degree': 15, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.5}
Trying parameters: {'kernel': 'rbf', 'nu': 0.99}
*
optimization finished, #iter = 478
obj = 0.006308, rho = 0.000062
nSV = 564, nBSV = 522
[LibSVM]PR AUC: 0.31, AUROC: 0.80
Trying parameters: {'ig_improvement': 0, 'max_depth': 2, 'min_subset': 0.05, 'n_jobs': -1, 'n_max_dim': 0, 'n_trees': 10, 'subsample_pct': 0.02, 'verbose': 0}
Trying parameters: {'ig_improvement': 0, 'max_depth': 3, 'min_subset': 0.05, 'n_jobs': -1, 'n_max_dim': 0, 'n_trees': 10, 'subsample_pct': 0.02, 'verbose': 0}
Trying parameters: {'ig_improvement': 0, 'max_depth': 4, 'min_subset': 0.05, 'n_jobs': -1, 'n_max_dim': 0, 'n_trees': 10, 'subsample_pct': 0.02, 'verbose': 0}
Trying parameters: {'ig_improvement': 0, 'max_depth': 5, 'min_subset': 0.05, 'n_jobs': -1, 'n_max_dim': 0, 'n_trees': 10, 'subsample_pct': 0.02, 'verbose': 0}
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 13964737324933869617
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 10921197568
locality {
  bus_id: 1
  links {
  }
}
incarnation: 903580399886504984
physical_device_desc: "device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:02:00.0, compute capability: 6.1"
]
(array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9], dtype=uint8), array([5923, 6742, 5958, 6131, 5842, 5421, 5918, 6265, 5851, 5949]))
6
(array([0, 1, 2, 3, 4, 5, 6, 7, 8], dtype=uint8), array([5923, 6742, 5958, 6131, 5842, 5421, 6265, 5851, 5949]))
x_train shape: (54082, 28, 28, 1)
54082 train samples
9042 test samples
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_1 (Conv2D)            (None, 26, 26, 32)        320       
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 24, 24, 64)        18496     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 12, 12, 64)        0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 12, 12, 64)        0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 9216)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 128)               1179776   
_________________________________________________________________
dropout_2 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 9)                 1161      
=================================================================
Total params: 1,199,753
Trainable params: 1,199,753
Non-trainable params: 0
_________________________________________________________________
None
Train on 54082 samples, validate on 9042 samples
Epoch 1/5

  128/54082 [..............................] - ETA: 8:54 - loss: 2.1936 - acc: 0.1484
  896/54082 [..............................] - ETA: 1:18 - loss: 1.9394 - acc: 0.3259
 1664/54082 [..............................] - ETA: 43s - loss: 1.7311 - acc: 0.4231 
 2432/54082 [>.............................] - ETA: 30s - loss: 1.5002 - acc: 0.4992
 3328/54082 [>.............................] - ETA: 22s - loss: 1.3103 - acc: 0.5661
 4224/54082 [=>............................] - ETA: 18s - loss: 1.1762 - acc: 0.6139
 5120/54082 [=>............................] - ETA: 15s - loss: 1.0602 - acc: 0.6520
 6016/54082 [==>...........................] - ETA: 13s - loss: 0.9668 - acc: 0.6823
 6784/54082 [==>...........................] - ETA: 11s - loss: 0.9027 - acc: 0.7043
 7552/54082 [===>..........................] - ETA: 10s - loss: 0.8449 - acc: 0.7240
 8320/54082 [===>..........................] - ETA: 9s - loss: 0.7997 - acc: 0.7401 
 9088/54082 [====>.........................] - ETA: 9s - loss: 0.7620 - acc: 0.7531
 9856/54082 [====>.........................] - ETA: 8s - loss: 0.7252 - acc: 0.7648
10624/54082 [====>.........................] - ETA: 8s - loss: 0.6910 - acc: 0.7761
11392/54082 [=====>........................] - ETA: 7s - loss: 0.6655 - acc: 0.7841
12160/54082 [=====>........................] - ETA: 7s - loss: 0.6424 - acc: 0.7922
12928/54082 [======>.......................] - ETA: 6s - loss: 0.6203 - acc: 0.7995
13696/54082 [======>.......................] - ETA: 6s - loss: 0.5990 - acc: 0.8070
14464/54082 [=======>......................] - ETA: 6s - loss: 0.5810 - acc: 0.8128
15232/54082 [=======>......................] - ETA: 5s - loss: 0.5642 - acc: 0.8187
16000/54082 [=======>......................] - ETA: 5s - loss: 0.5500 - acc: 0.8238
16768/54082 [========>.....................] - ETA: 5s - loss: 0.5335 - acc: 0.8292
17536/54082 [========>.....................] - ETA: 5s - loss: 0.5204 - acc: 0.8337
18304/54082 [=========>....................] - ETA: 4s - loss: 0.5052 - acc: 0.8389
19072/54082 [=========>....................] - ETA: 4s - loss: 0.4926 - acc: 0.8430
19840/54082 [==========>...................] - ETA: 4s - loss: 0.4813 - acc: 0.8466
20608/54082 [==========>...................] - ETA: 4s - loss: 0.4715 - acc: 0.8495
21376/54082 [==========>...................] - ETA: 4s - loss: 0.4619 - acc: 0.8531
22144/54082 [===========>..................] - ETA: 3s - loss: 0.4517 - acc: 0.8564
22912/54082 [===========>..................] - ETA: 3s - loss: 0.4433 - acc: 0.8592
23680/54082 [============>.................] - ETA: 3s - loss: 0.4347 - acc: 0.8620
24448/54082 [============>.................] - ETA: 3s - loss: 0.4265 - acc: 0.8650
25216/54082 [============>.................] - ETA: 3s - loss: 0.4184 - acc: 0.8674
25984/54082 [=============>................] - ETA: 3s - loss: 0.4112 - acc: 0.8697
26752/54082 [=============>................] - ETA: 3s - loss: 0.4038 - acc: 0.8721
27520/54082 [==============>...............] - ETA: 3s - loss: 0.3968 - acc: 0.8742
28288/54082 [==============>...............] - ETA: 2s - loss: 0.3904 - acc: 0.8762
29056/54082 [===============>..............] - ETA: 2s - loss: 0.3834 - acc: 0.8785
29952/54082 [===============>..............] - ETA: 2s - loss: 0.3784 - acc: 0.8803
30720/54082 [================>.............] - ETA: 2s - loss: 0.3733 - acc: 0.8819
31616/54082 [================>.............] - ETA: 2s - loss: 0.3666 - acc: 0.8842
32384/54082 [================>.............] - ETA: 2s - loss: 0.3603 - acc: 0.8863
33280/54082 [=================>............] - ETA: 2s - loss: 0.3551 - acc: 0.8880
34176/54082 [=================>............] - ETA: 2s - loss: 0.3495 - acc: 0.8898
35072/54082 [==================>...........] - ETA: 1s - loss: 0.3442 - acc: 0.8916
35968/54082 [==================>...........] - ETA: 1s - loss: 0.3390 - acc: 0.8934
36736/54082 [===================>..........] - ETA: 1s - loss: 0.3343 - acc: 0.8949
37504/54082 [===================>..........] - ETA: 1s - loss: 0.3317 - acc: 0.8959
38272/54082 [====================>.........] - ETA: 1s - loss: 0.3278 - acc: 0.8972
39040/54082 [====================>.........] - ETA: 1s - loss: 0.3240 - acc: 0.8984
39936/54082 [=====================>........] - ETA: 1s - loss: 0.3201 - acc: 0.8997
40832/54082 [=====================>........] - ETA: 1s - loss: 0.3155 - acc: 0.9012
41728/54082 [======================>.......] - ETA: 1s - loss: 0.3120 - acc: 0.9023
42624/54082 [======================>.......] - ETA: 1s - loss: 0.3080 - acc: 0.9036
43520/54082 [=======================>......] - ETA: 1s - loss: 0.3038 - acc: 0.9049
44416/54082 [=======================>......] - ETA: 0s - loss: 0.3008 - acc: 0.9059
45312/54082 [========================>.....] - ETA: 0s - loss: 0.2973 - acc: 0.9070
46208/54082 [========================>.....] - ETA: 0s - loss: 0.2940 - acc: 0.9081
46976/54082 [=========================>....] - ETA: 0s - loss: 0.2915 - acc: 0.9090
47872/54082 [=========================>....] - ETA: 0s - loss: 0.2875 - acc: 0.9104
48640/54082 [=========================>....] - ETA: 0s - loss: 0.2847 - acc: 0.9114
49408/54082 [==========================>...] - ETA: 0s - loss: 0.2823 - acc: 0.9121
50176/54082 [==========================>...] - ETA: 0s - loss: 0.2794 - acc: 0.9129
50944/54082 [===========================>..] - ETA: 0s - loss: 0.2764 - acc: 0.9138
51712/54082 [===========================>..] - ETA: 0s - loss: 0.2734 - acc: 0.9147
52608/54082 [============================>.] - ETA: 0s - loss: 0.2710 - acc: 0.9155
53504/54082 [============================>.] - ETA: 0s - loss: 0.2682 - acc: 0.9164
54082/54082 [==============================] - 7s 126us/step - loss: 0.2668 - acc: 0.9169 - val_loss: 0.0588 - val_acc: 0.9806
Epoch 2/5

  128/54082 [..............................] - ETA: 4s - loss: 0.0660 - acc: 0.9844
  768/54082 [..............................] - ETA: 4s - loss: 0.0949 - acc: 0.9674
 1536/54082 [..............................] - ETA: 4s - loss: 0.1008 - acc: 0.9668
 2176/54082 [>.............................] - ETA: 4s - loss: 0.0951 - acc: 0.9697
 2944/54082 [>.............................] - ETA: 4s - loss: 0.1000 - acc: 0.9681
 3840/54082 [=>............................] - ETA: 3s - loss: 0.0999 - acc: 0.9680
 4736/54082 [=>............................] - ETA: 3s - loss: 0.0973 - acc: 0.9696
 5504/54082 [==>...........................] - ETA: 3s - loss: 0.1012 - acc: 0.9680
 6272/54082 [==>...........................] - ETA: 3s - loss: 0.1024 - acc: 0.9684
 7040/54082 [==>...........................] - ETA: 3s - loss: 0.1028 - acc: 0.9688
 7552/54082 [===>..........................] - ETA: 3s - loss: 0.1059 - acc: 0.9678
 8064/54082 [===>..........................] - ETA: 3s - loss: 0.1045 - acc: 0.9685
 8576/54082 [===>..........................] - ETA: 3s - loss: 0.1034 - acc: 0.9688
 9216/54082 [====>.........................] - ETA: 3s - loss: 0.1025 - acc: 0.9692
 9728/54082 [====>.........................] - ETA: 3s - loss: 0.1007 - acc: 0.9699
10624/54082 [====>.........................] - ETA: 3s - loss: 0.0988 - acc: 0.9704
11136/54082 [=====>........................] - ETA: 3s - loss: 0.0987 - acc: 0.9698
11648/54082 [=====>........................] - ETA: 3s - loss: 0.1002 - acc: 0.9695
12288/54082 [=====>........................] - ETA: 3s - loss: 0.0998 - acc: 0.9696
13184/54082 [======>.......................] - ETA: 3s - loss: 0.0988 - acc: 0.9697
14080/54082 [======>.......................] - ETA: 3s - loss: 0.0979 - acc: 0.9696
14976/54082 [=======>......................] - ETA: 3s - loss: 0.0980 - acc: 0.9698
15872/54082 [=======>......................] - ETA: 3s - loss: 0.0967 - acc: 0.9703
16768/54082 [========>.....................] - ETA: 2s - loss: 0.0964 - acc: 0.9706
17664/54082 [========>.....................] - ETA: 2s - loss: 0.0960 - acc: 0.9708
18432/54082 [=========>....................] - ETA: 2s - loss: 0.0971 - acc: 0.9706
19200/54082 [=========>....................] - ETA: 2s - loss: 0.0960 - acc: 0.9711
20096/54082 [==========>...................] - ETA: 2s - loss: 0.0950 - acc: 0.9712
20992/54082 [==========>...................] - ETA: 2s - loss: 0.0943 - acc: 0.9714
21888/54082 [===========>..................] - ETA: 2s - loss: 0.0955 - acc: 0.9710
22656/54082 [===========>..................] - ETA: 2s - loss: 0.0951 - acc: 0.9710
23552/54082 [============>.................] - ETA: 2s - loss: 0.0941 - acc: 0.9713
24448/54082 [============>.................] - ETA: 2s - loss: 0.0936 - acc: 0.9715
25344/54082 [=============>................] - ETA: 2s - loss: 0.0928 - acc: 0.9718
26112/54082 [=============>................] - ETA: 2s - loss: 0.0919 - acc: 0.9723
26880/54082 [=============>................] - ETA: 1s - loss: 0.0912 - acc: 0.9725
27776/54082 [==============>...............] - ETA: 1s - loss: 0.0912 - acc: 0.9723
28544/54082 [==============>...............] - ETA: 1s - loss: 0.0912 - acc: 0.9721
29440/54082 [===============>..............] - ETA: 1s - loss: 0.0906 - acc: 0.9724
30336/54082 [===============>..............] - ETA: 1s - loss: 0.0896 - acc: 0.9726
31104/54082 [================>.............] - ETA: 1s - loss: 0.0896 - acc: 0.9727
32000/54082 [================>.............] - ETA: 1s - loss: 0.0894 - acc: 0.9730
32768/54082 [=================>............] - ETA: 1s - loss: 0.0896 - acc: 0.9729
33664/54082 [=================>............] - ETA: 1s - loss: 0.0900 - acc: 0.9729
34432/54082 [==================>...........] - ETA: 1s - loss: 0.0897 - acc: 0.9732
35200/54082 [==================>...........] - ETA: 1s - loss: 0.0893 - acc: 0.9733
36096/54082 [===================>..........] - ETA: 1s - loss: 0.0891 - acc: 0.9733
36992/54082 [===================>..........] - ETA: 1s - loss: 0.0894 - acc: 0.9733
37888/54082 [====================>.........] - ETA: 1s - loss: 0.0889 - acc: 0.9733
38784/54082 [====================>.........] - ETA: 1s - loss: 0.0886 - acc: 0.9734
39680/54082 [=====================>........] - ETA: 1s - loss: 0.0884 - acc: 0.9736
40576/54082 [=====================>........] - ETA: 0s - loss: 0.0882 - acc: 0.9736
41472/54082 [======================>.......] - ETA: 0s - loss: 0.0880 - acc: 0.9737
42368/54082 [======================>.......] - ETA: 0s - loss: 0.0877 - acc: 0.9738
43136/54082 [======================>.......] - ETA: 0s - loss: 0.0874 - acc: 0.9739
44032/54082 [=======================>......] - ETA: 0s - loss: 0.0872 - acc: 0.9740
44928/54082 [=======================>......] - ETA: 0s - loss: 0.0867 - acc: 0.9741
45824/54082 [========================>.....] - ETA: 0s - loss: 0.0869 - acc: 0.9742
46720/54082 [========================>.....] - ETA: 0s - loss: 0.0864 - acc: 0.9744
47616/54082 [=========================>....] - ETA: 0s - loss: 0.0864 - acc: 0.9744
48512/54082 [=========================>....] - ETA: 0s - loss: 0.0863 - acc: 0.9745
49408/54082 [==========================>...] - ETA: 0s - loss: 0.0863 - acc: 0.9745
50304/54082 [==========================>...] - ETA: 0s - loss: 0.0861 - acc: 0.9746
51200/54082 [===========================>..] - ETA: 0s - loss: 0.0861 - acc: 0.9746
52096/54082 [===========================>..] - ETA: 0s - loss: 0.0856 - acc: 0.9747
52992/54082 [============================>.] - ETA: 0s - loss: 0.0849 - acc: 0.9748
53888/54082 [============================>.] - ETA: 0s - loss: 0.0851 - acc: 0.9748
54082/54082 [==============================] - 4s 72us/step - loss: 0.0851 - acc: 0.9748 - val_loss: 0.0333 - val_acc: 0.9881
Epoch 3/5

  128/54082 [..............................] - ETA: 4s - loss: 0.0983 - acc: 0.9531
 1024/54082 [..............................] - ETA: 3s - loss: 0.0612 - acc: 0.9795
 1920/54082 [>.............................] - ETA: 3s - loss: 0.0653 - acc: 0.9776
 2816/54082 [>.............................] - ETA: 3s - loss: 0.0677 - acc: 0.9769
 3584/54082 [>.............................] - ETA: 3s - loss: 0.0634 - acc: 0.9788
 4480/54082 [=>............................] - ETA: 3s - loss: 0.0585 - acc: 0.9806
 5376/54082 [=>............................] - ETA: 3s - loss: 0.0579 - acc: 0.9810
 6400/54082 [==>...........................] - ETA: 2s - loss: 0.0583 - acc: 0.9809
 7296/54082 [===>..........................] - ETA: 2s - loss: 0.0587 - acc: 0.9814
 8192/54082 [===>..........................] - ETA: 2s - loss: 0.0611 - acc: 0.9806
 9088/54082 [====>.........................] - ETA: 2s - loss: 0.0621 - acc: 0.9802
 9984/54082 [====>.........................] - ETA: 2s - loss: 0.0642 - acc: 0.9792
10880/54082 [=====>........................] - ETA: 2s - loss: 0.0650 - acc: 0.9791
11776/54082 [=====>........................] - ETA: 2s - loss: 0.0645 - acc: 0.9797
12544/54082 [=====>........................] - ETA: 2s - loss: 0.0647 - acc: 0.9798
13440/54082 [======>.......................] - ETA: 2s - loss: 0.0640 - acc: 0.9801
14336/54082 [======>.......................] - ETA: 2s - loss: 0.0623 - acc: 0.9805
15232/54082 [=======>......................] - ETA: 2s - loss: 0.0621 - acc: 0.9806
16128/54082 [=======>......................] - ETA: 2s - loss: 0.0609 - acc: 0.9811
17024/54082 [========>.....................] - ETA: 2s - loss: 0.0628 - acc: 0.9806
17920/54082 [========>.....................] - ETA: 2s - loss: 0.0633 - acc: 0.9804
18816/54082 [=========>....................] - ETA: 2s - loss: 0.0637 - acc: 0.9803
19584/54082 [=========>....................] - ETA: 2s - loss: 0.0640 - acc: 0.9805
20480/54082 [==========>...................] - ETA: 2s - loss: 0.0633 - acc: 0.9804
21376/54082 [==========>...................] - ETA: 1s - loss: 0.0630 - acc: 0.9806
22272/54082 [===========>..................] - ETA: 1s - loss: 0.0625 - acc: 0.9807
23040/54082 [===========>..................] - ETA: 1s - loss: 0.0626 - acc: 0.9809
23936/54082 [============>.................] - ETA: 1s - loss: 0.0623 - acc: 0.9809
24832/54082 [============>.................] - ETA: 1s - loss: 0.0628 - acc: 0.9809
25728/54082 [=============>................] - ETA: 1s - loss: 0.0628 - acc: 0.9810
26496/54082 [=============>................] - ETA: 1s - loss: 0.0622 - acc: 0.9811
27392/54082 [==============>...............] - ETA: 1s - loss: 0.0620 - acc: 0.9813
28288/54082 [==============>...............] - ETA: 1s - loss: 0.0628 - acc: 0.9811
29184/54082 [===============>..............] - ETA: 1s - loss: 0.0629 - acc: 0.9811
30080/54082 [===============>..............] - ETA: 1s - loss: 0.0625 - acc: 0.9812
30976/54082 [================>.............] - ETA: 1s - loss: 0.0624 - acc: 0.9813
32000/54082 [================>.............] - ETA: 1s - loss: 0.0617 - acc: 0.9815
32896/54082 [=================>............] - ETA: 1s - loss: 0.0615 - acc: 0.9816
33664/54082 [=================>............] - ETA: 1s - loss: 0.0616 - acc: 0.9817
34560/54082 [==================>...........] - ETA: 1s - loss: 0.0615 - acc: 0.9818
35456/54082 [==================>...........] - ETA: 1s - loss: 0.0619 - acc: 0.9818
36352/54082 [===================>..........] - ETA: 1s - loss: 0.0616 - acc: 0.9820
37248/54082 [===================>..........] - ETA: 1s - loss: 0.0613 - acc: 0.9820
38144/54082 [====================>.........] - ETA: 0s - loss: 0.0611 - acc: 0.9820
39040/54082 [====================>.........] - ETA: 0s - loss: 0.0612 - acc: 0.9820
39936/54082 [=====================>........] - ETA: 0s - loss: 0.0613 - acc: 0.9820
40832/54082 [=====================>........] - ETA: 0s - loss: 0.0614 - acc: 0.9820
41600/54082 [======================>.......] - ETA: 0s - loss: 0.0617 - acc: 0.9819
42496/54082 [======================>.......] - ETA: 0s - loss: 0.0617 - acc: 0.9820
43264/54082 [======================>.......] - ETA: 0s - loss: 0.0614 - acc: 0.9820
44032/54082 [=======================>......] - ETA: 0s - loss: 0.0613 - acc: 0.9819
44800/54082 [=======================>......] - ETA: 0s - loss: 0.0609 - acc: 0.9821
45696/54082 [========================>.....] - ETA: 0s - loss: 0.0608 - acc: 0.9820
46592/54082 [========================>.....] - ETA: 0s - loss: 0.0608 - acc: 0.9821
47488/54082 [=========================>....] - ETA: 0s - loss: 0.0609 - acc: 0.9820
48384/54082 [=========================>....] - ETA: 0s - loss: 0.0606 - acc: 0.9821
49280/54082 [==========================>...] - ETA: 0s - loss: 0.0613 - acc: 0.9820
50176/54082 [==========================>...] - ETA: 0s - loss: 0.0612 - acc: 0.9819
51072/54082 [===========================>..] - ETA: 0s - loss: 0.0613 - acc: 0.9819
51968/54082 [===========================>..] - ETA: 0s - loss: 0.0608 - acc: 0.9821
52864/54082 [============================>.] - ETA: 0s - loss: 0.0606 - acc: 0.9822
53760/54082 [============================>.] - ETA: 0s - loss: 0.0608 - acc: 0.9821
54082/54082 [==============================] - 3s 64us/step - loss: 0.0608 - acc: 0.9821 - val_loss: 0.0297 - val_acc: 0.9888
Epoch 4/5

  128/54082 [..............................] - ETA: 4s - loss: 0.0324 - acc: 0.9922
 1024/54082 [..............................] - ETA: 3s - loss: 0.0417 - acc: 0.9873
 1920/54082 [>.............................] - ETA: 3s - loss: 0.0448 - acc: 0.9875
 2816/54082 [>.............................] - ETA: 3s - loss: 0.0494 - acc: 0.9844
 3712/54082 [=>............................] - ETA: 3s - loss: 0.0465 - acc: 0.9852
 4608/54082 [=>............................] - ETA: 3s - loss: 0.0507 - acc: 0.9839
 5504/54082 [==>...........................] - ETA: 2s - loss: 0.0489 - acc: 0.9840
 6400/54082 [==>...........................] - ETA: 2s - loss: 0.0505 - acc: 0.9836
 7296/54082 [===>..........................] - ETA: 2s - loss: 0.0494 - acc: 0.9841
 8192/54082 [===>..........................] - ETA: 2s - loss: 0.0493 - acc: 0.9841
 9088/54082 [====>.........................] - ETA: 2s - loss: 0.0491 - acc: 0.9840
 9984/54082 [====>.........................] - ETA: 2s - loss: 0.0485 - acc: 0.9842
10880/54082 [=====>........................] - ETA: 2s - loss: 0.0487 - acc: 0.9840
11776/54082 [=====>........................] - ETA: 2s - loss: 0.0488 - acc: 0.9840
12544/54082 [=====>........................] - ETA: 2s - loss: 0.0506 - acc: 0.9837
13440/54082 [======>.......................] - ETA: 2s - loss: 0.0502 - acc: 0.9839
14336/54082 [======>.......................] - ETA: 2s - loss: 0.0500 - acc: 0.9840
15104/54082 [=======>......................] - ETA: 2s - loss: 0.0494 - acc: 0.9840
16000/54082 [=======>......................] - ETA: 2s - loss: 0.0504 - acc: 0.9841
16896/54082 [========>.....................] - ETA: 2s - loss: 0.0501 - acc: 0.9844
17792/54082 [========>.....................] - ETA: 2s - loss: 0.0493 - acc: 0.9848
18688/54082 [=========>....................] - ETA: 2s - loss: 0.0498 - acc: 0.9847
19584/54082 [=========>....................] - ETA: 2s - loss: 0.0497 - acc: 0.9848
20480/54082 [==========>...................] - ETA: 2s - loss: 0.0495 - acc: 0.9850
21376/54082 [==========>...................] - ETA: 1s - loss: 0.0492 - acc: 0.9851
22272/54082 [===========>..................] - ETA: 1s - loss: 0.0488 - acc: 0.9852
23168/54082 [===========>..................] - ETA: 1s - loss: 0.0488 - acc: 0.9852
24064/54082 [============>.................] - ETA: 1s - loss: 0.0495 - acc: 0.9850
24960/54082 [============>.................] - ETA: 1s - loss: 0.0494 - acc: 0.9849
25984/54082 [=============>................] - ETA: 1s - loss: 0.0491 - acc: 0.9849
27008/54082 [=============>................] - ETA: 1s - loss: 0.0490 - acc: 0.9850
28032/54082 [==============>...............] - ETA: 1s - loss: 0.0497 - acc: 0.9848
29056/54082 [===============>..............] - ETA: 1s - loss: 0.0498 - acc: 0.9847
30080/54082 [===============>..............] - ETA: 1s - loss: 0.0491 - acc: 0.9848
31104/54082 [================>.............] - ETA: 1s - loss: 0.0498 - acc: 0.9846
32000/54082 [================>.............] - ETA: 1s - loss: 0.0500 - acc: 0.9845
32896/54082 [=================>............] - ETA: 1s - loss: 0.0498 - acc: 0.9846
33920/54082 [=================>............] - ETA: 1s - loss: 0.0498 - acc: 0.9847
34688/54082 [==================>...........] - ETA: 1s - loss: 0.0504 - acc: 0.9847
35584/54082 [==================>...........] - ETA: 1s - loss: 0.0501 - acc: 0.9848
36608/54082 [===================>..........] - ETA: 1s - loss: 0.0506 - acc: 0.9846
37504/54082 [===================>..........] - ETA: 0s - loss: 0.0506 - acc: 0.9847
38400/54082 [====================>.........] - ETA: 0s - loss: 0.0507 - acc: 0.9845
39168/54082 [====================>.........] - ETA: 0s - loss: 0.0512 - acc: 0.9844
40064/54082 [=====================>........] - ETA: 0s - loss: 0.0512 - acc: 0.9845
40960/54082 [=====================>........] - ETA: 0s - loss: 0.0510 - acc: 0.9845
41856/54082 [======================>.......] - ETA: 0s - loss: 0.0512 - acc: 0.9845
42752/54082 [======================>.......] - ETA: 0s - loss: 0.0513 - acc: 0.9845
43776/54082 [=======================>......] - ETA: 0s - loss: 0.0516 - acc: 0.9845
44800/54082 [=======================>......] - ETA: 0s - loss: 0.0510 - acc: 0.9847
45824/54082 [========================>.....] - ETA: 0s - loss: 0.0513 - acc: 0.9846
46720/54082 [========================>.....] - ETA: 0s - loss: 0.0517 - acc: 0.9845
47616/54082 [=========================>....] - ETA: 0s - loss: 0.0513 - acc: 0.9846
48640/54082 [=========================>....] - ETA: 0s - loss: 0.0515 - acc: 0.9845
49408/54082 [==========================>...] - ETA: 0s - loss: 0.0518 - acc: 0.9845
50176/54082 [==========================>...] - ETA: 0s - loss: 0.0517 - acc: 0.9844
50816/54082 [===========================>..] - ETA: 0s - loss: 0.0518 - acc: 0.9844
51712/54082 [===========================>..] - ETA: 0s - loss: 0.0517 - acc: 0.9845
52608/54082 [============================>.] - ETA: 0s - loss: 0.0514 - acc: 0.9845
53504/54082 [============================>.] - ETA: 0s - loss: 0.0517 - acc: 0.9844
54082/54082 [==============================] - 3s 63us/step - loss: 0.0515 - acc: 0.9845 - val_loss: 0.0286 - val_acc: 0.9903
Epoch 5/5

  128/54082 [..............................] - ETA: 5s - loss: 0.0424 - acc: 0.9844
  640/54082 [..............................] - ETA: 5s - loss: 0.0387 - acc: 0.9859
 1408/54082 [..............................] - ETA: 4s - loss: 0.0328 - acc: 0.9879
 2304/54082 [>.............................] - ETA: 3s - loss: 0.0381 - acc: 0.9861
 3200/54082 [>.............................] - ETA: 3s - loss: 0.0373 - acc: 0.9859
 4096/54082 [=>............................] - ETA: 3s - loss: 0.0340 - acc: 0.9883
 4992/54082 [=>............................] - ETA: 3s - loss: 0.0385 - acc: 0.9876
 5888/54082 [==>...........................] - ETA: 3s - loss: 0.0410 - acc: 0.9864
 6784/54082 [==>...........................] - ETA: 3s - loss: 0.0423 - acc: 0.9867
 7680/54082 [===>..........................] - ETA: 3s - loss: 0.0423 - acc: 0.9870
 8576/54082 [===>..........................] - ETA: 2s - loss: 0.0425 - acc: 0.9869
 9472/54082 [====>.........................] - ETA: 2s - loss: 0.0422 - acc: 0.9869
10368/54082 [====>.........................] - ETA: 2s - loss: 0.0419 - acc: 0.9870
11264/54082 [=====>........................] - ETA: 2s - loss: 0.0426 - acc: 0.9869
12160/54082 [=====>........................] - ETA: 2s - loss: 0.0426 - acc: 0.9867
13056/54082 [======>.......................] - ETA: 2s - loss: 0.0426 - acc: 0.9864
13952/54082 [======>.......................] - ETA: 2s - loss: 0.0421 - acc: 0.9865
14848/54082 [=======>......................] - ETA: 2s - loss: 0.0424 - acc: 0.9864
15744/54082 [=======>......................] - ETA: 2s - loss: 0.0427 - acc: 0.9865
16640/54082 [========>.....................] - ETA: 2s - loss: 0.0427 - acc: 0.9866
17536/54082 [========>.....................] - ETA: 2s - loss: 0.0425 - acc: 0.9867
18432/54082 [=========>....................] - ETA: 2s - loss: 0.0422 - acc: 0.9869
19328/54082 [=========>....................] - ETA: 2s - loss: 0.0424 - acc: 0.9869
20224/54082 [==========>...................] - ETA: 2s - loss: 0.0435 - acc: 0.9866
21120/54082 [==========>...................] - ETA: 2s - loss: 0.0433 - acc: 0.9867
22016/54082 [===========>..................] - ETA: 1s - loss: 0.0430 - acc: 0.9867
22912/54082 [===========>..................] - ETA: 1s - loss: 0.0430 - acc: 0.9867
23808/54082 [============>.................] - ETA: 1s - loss: 0.0431 - acc: 0.9867
24704/54082 [============>.................] - ETA: 1s - loss: 0.0433 - acc: 0.9865
25600/54082 [=============>................] - ETA: 1s - loss: 0.0427 - acc: 0.9866
26496/54082 [=============>................] - ETA: 1s - loss: 0.0423 - acc: 0.9868
27392/54082 [==============>...............] - ETA: 1s - loss: 0.0424 - acc: 0.9867
28288/54082 [==============>...............] - ETA: 1s - loss: 0.0422 - acc: 0.9866
29184/54082 [===============>..............] - ETA: 1s - loss: 0.0418 - acc: 0.9867
30080/54082 [===============>..............] - ETA: 1s - loss: 0.0423 - acc: 0.9866
30976/54082 [================>.............] - ETA: 1s - loss: 0.0426 - acc: 0.9865
31872/54082 [================>.............] - ETA: 1s - loss: 0.0431 - acc: 0.9863
32768/54082 [=================>............] - ETA: 1s - loss: 0.0436 - acc: 0.9861
33664/54082 [=================>............] - ETA: 1s - loss: 0.0433 - acc: 0.9861
34560/54082 [==================>...........] - ETA: 1s - loss: 0.0432 - acc: 0.9861
35456/54082 [==================>...........] - ETA: 1s - loss: 0.0432 - acc: 0.9862
36352/54082 [===================>..........] - ETA: 1s - loss: 0.0437 - acc: 0.9862
37248/54082 [===================>..........] - ETA: 1s - loss: 0.0437 - acc: 0.9861
38016/54082 [====================>.........] - ETA: 0s - loss: 0.0437 - acc: 0.9862
38912/54082 [====================>.........] - ETA: 0s - loss: 0.0434 - acc: 0.9863
39808/54082 [=====================>........] - ETA: 0s - loss: 0.0429 - acc: 0.9864
40576/54082 [=====================>........] - ETA: 0s - loss: 0.0429 - acc: 0.9864
41472/54082 [======================>.......] - ETA: 0s - loss: 0.0426 - acc: 0.9865
42368/54082 [======================>.......] - ETA: 0s - loss: 0.0426 - acc: 0.9865
43264/54082 [======================>.......] - ETA: 0s - loss: 0.0426 - acc: 0.9865
44160/54082 [=======================>......] - ETA: 0s - loss: 0.0425 - acc: 0.9866
45056/54082 [=======================>......] - ETA: 0s - loss: 0.0426 - acc: 0.9866
45952/54082 [========================>.....] - ETA: 0s - loss: 0.0425 - acc: 0.9866
46848/54082 [========================>.....] - ETA: 0s - loss: 0.0427 - acc: 0.9866
47744/54082 [=========================>....] - ETA: 0s - loss: 0.0427 - acc: 0.9867
48640/54082 [=========================>....] - ETA: 0s - loss: 0.0425 - acc: 0.9867
49536/54082 [==========================>...] - ETA: 0s - loss: 0.0430 - acc: 0.9868
50432/54082 [==========================>...] - ETA: 0s - loss: 0.0434 - acc: 0.9866
51328/54082 [===========================>..] - ETA: 0s - loss: 0.0435 - acc: 0.9867
52224/54082 [===========================>..] - ETA: 0s - loss: 0.0435 - acc: 0.9867
53120/54082 [============================>.] - ETA: 0s - loss: 0.0432 - acc: 0.9868
54016/54082 [============================>.] - ETA: 0s - loss: 0.0435 - acc: 0.9868
54082/54082 [==============================] - 3s 64us/step - loss: 0.0435 - acc: 0.9868 - val_loss: 0.0305 - val_acc: 0.9894
Test loss: 0.030492635456692063
Test accuracy: 0.9893828798938288
Mean accuracy: 66.68 %
Std accuracy: 31.19 %
25.16% of all predictions made with an accuracy higher than 0.95%
Mean accuracy: 98.38 %
Std accuracy: 8.91 %
95.43 % of all predictions made with an accuracy higher than 0.95%
(1, 1, 24, 24, 64)
(958, 128)
(60000, 128)
(54082, 128)
(10000, 128)
[t-SNE] Computing 91 nearest neighbors...
[t-SNE] Indexed 10000 samples in 0.007s...
[t-SNE] Computed neighbors for 10000 samples in 0.903s...
[t-SNE] Computed conditional probabilities for sample 1000 / 10000
[t-SNE] Computed conditional probabilities for sample 2000 / 10000
[t-SNE] Computed conditional probabilities for sample 3000 / 10000
[t-SNE] Computed conditional probabilities for sample 4000 / 10000
[t-SNE] Computed conditional probabilities for sample 5000 / 10000
[t-SNE] Computed conditional probabilities for sample 6000 / 10000
[t-SNE] Computed conditional probabilities for sample 7000 / 10000
[t-SNE] Computed conditional probabilities for sample 8000 / 10000
[t-SNE] Computed conditional probabilities for sample 9000 / 10000
[t-SNE] Computed conditional probabilities for sample 10000 / 10000
[t-SNE] Mean sigma: 1.418767
[t-SNE] KL divergence after 250 iterations with early exaggeration: 73.026932
[t-SNE] Error after 300 iterations: 2.681867
Trying parameters: {'max_iter': 10000, 'n_components': 4}
Trying parameters: {'max_iter': 10000, 'n_components': 5}
Trying parameters: {'max_iter': 10000, 'n_components': 8}
Trying parameters: {'max_iter': 10000, 'n_components': 6}
Trying parameters: {'max_iter': 10000, 'n_components': 11}
{'max_iter': 10000, 'n_components': 8}
PR AUC: 0.51, AUROC: 0.91
Trying parameters: {'degree': 1, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.1}
Trying parameters: {'degree': 9, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.01}
Trying parameters: {'degree': 13, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.01}
Trying parameters: {'degree': 16, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.01}
Trying parameters: {'degree': 4, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.01}
Trying parameters: {'degree': 9, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.001}
Trying parameters: {'degree': 12, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.1}
Trying parameters: {'degree': 2, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.3}
Trying parameters: {'degree': 4, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.1}
Trying parameters: {'degree': 13, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.0001}
Trying parameters: {'degree': 14, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.01}
Trying parameters: {'degree': 15, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.01}
Trying parameters: {'degree': 5, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.1}
Trying parameters: {'degree': 14, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.0001}
Trying parameters: {'degree': 14, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.1}
Trying parameters: {'degree': 1, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.5}
Trying parameters: {'degree': 3, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.3}
Trying parameters: {'degree': 3, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.001}
Trying parameters: {'degree': 10, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.0001}
Trying parameters: {'degree': 10, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.3}
Trying parameters: {'degree': 5, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.3}
Trying parameters: {'degree': 3, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.1}
Trying parameters: {'degree': 13, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.001}
Trying parameters: {'degree': 15, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.1}
Trying parameters: {'degree': 6, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.01}
Trying parameters: {'degree': 10, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.1}
Trying parameters: {'degree': 16, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.0001}
Trying parameters: {'degree': 16, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.001}
Trying parameters: {'degree': 16, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.1}
Trying parameters: {'degree': 6, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.0001}
Trying parameters: {'degree': 8, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.3}
Trying parameters: {'degree': 6, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.001}
Trying parameters: {'degree': 9, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.0001}
Trying parameters: {'degree': 11, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.3}
Trying parameters: {'degree': 6, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.3}
Trying parameters: {'degree': 2, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.5}
Trying parameters: {'degree': 1, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.001}
Trying parameters: {'degree': 7, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.01}
Trying parameters: {'degree': 12, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.0001}
Trying parameters: {'degree': 12, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.01}
Trying parameters: {'degree': 13, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.1}
Trying parameters: {'degree': 2, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.0001}
Trying parameters: {'degree': 7, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.3}
Trying parameters: {'degree': 3, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.5}
Trying parameters: {'degree': 4, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.5}
Trying parameters: {'degree': 5, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.01}
Trying parameters: {'degree': 11, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.001}
Trying parameters: {'degree': 13, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.3}
Trying parameters: {'degree': 2, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.01}
Trying parameters: {'degree': 8, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.001}
Trying parameters: {'degree': 9, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.3}
Trying parameters: {'degree': 5, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.001}
Trying parameters: {'degree': 10, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.01}
Trying parameters: {'degree': 12, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.001}
Trying parameters: {'degree': 12, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.3}
Trying parameters: {'degree': 5, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.5}
Trying parameters: {'degree': 1, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.3}
Trying parameters: {'degree': 14, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.3}
Trying parameters: {'degree': 6, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.5}
Trying parameters: {'degree': 3, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.0001}
Trying parameters: {'degree': 8, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.5}
Trying parameters: {'degree': 4, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.3}
Trying parameters: {'degree': 3, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.01}
Trying parameters: {'degree': 9, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.5}
Trying parameters: {'degree': 2, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.001}
Trying parameters: {'degree': 7, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.5}
Trying parameters: {'degree': 7, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.0001}
Trying parameters: {'degree': 10, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.5}
Trying parameters: {'degree': 1, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.01}
Trying parameters: {'degree': 7, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.1}
Trying parameters: {'degree': 15, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.0001}
Trying parameters: {'degree': 15, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.3}
Trying parameters: {'degree': 2, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.1}
Trying parameters: {'degree': 11, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.5}
Trying parameters: {'degree': 5, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.0001}
Trying parameters: {'degree': 10, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.001}
Trying parameters: {'degree': 11, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.0001}
Trying parameters: {'degree': 12, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.5}
Trying parameters: {'kernel': 'rbf', 'nu': 0.001}
Trying parameters: {'degree': 8, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.0001}
Trying parameters: {'degree': 9, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.1}
Trying parameters: {'degree': 15, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.5}
Trying parameters: {'degree': 4, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.001}
Trying parameters: {'degree': 8, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.1}
Trying parameters: {'degree': 15, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.001}
Trying parameters: {'degree': 16, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.3}
Trying parameters: {'degree': 6, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.1}
Trying parameters: {'degree': 13, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.5}
Trying parameters: {'degree': 4, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.0001}
Trying parameters: {'degree': 8, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.01}
Trying parameters: {'degree': 11, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.01}
Trying parameters: {'degree': 14, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.001}
Trying parameters: {'degree': 14, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.5}
Trying parameters: {'degree': 1, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.0001}
Trying parameters: {'degree': 7, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.001}
Trying parameters: {'degree': 11, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.1}
Trying parameters: {'degree': 16, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.5}
Trying parameters: {'kernel': 'rbf', 'nu': 0.5}
..
Warning: using -h 0 may be faster
*.
Warning: using -h 0 may be faster
*
optimization finished, #iter = 3270
obj = 0.004631, rho = 0.000028
nSV = 1341, nBSV = 385
{'degree': 13, 'kernel': 'poly', 'max_iter': 10000, 'nu': 0.01}
[LibSVM]PR AUC: 0.49, AUROC: 0.89
Trying parameters: {'ig_improvement': 0, 'max_depth': 2, 'min_subset': 0.05, 'n_jobs': -1, 'n_max_dim': 0, 'n_trees': 10, 'subsample_pct': 0.02, 'verbose': 0}
Trying parameters: {'ig_improvement': 0, 'max_depth': 3, 'min_subset': 0.05, 'n_jobs': -1, 'n_max_dim': 0, 'n_trees': 10, 'subsample_pct': 0.02, 'verbose': 0}
Trying parameters: {'ig_improvement': 0, 'max_depth': 4, 'min_subset': 0.05, 'n_jobs': -1, 'n_max_dim': 0, 'n_trees': 10, 'subsample_pct': 0.02, 'verbose': 0}
Trying parameters: {'ig_improvement': 0, 'max_depth': 5, 'min_subset': 0.05, 'n_jobs': -1, 'n_max_dim': 0, 'n_trees': 10, 'subsample_pct': 0.02, 'verbose': 0}
Trying parameters: {'ig_improvement': 0.3, 'max_depth': 2, 'min_subset': 0.05, 'n_jobs': -1, 'n_max_dim': 0, 'n_trees': 10, 'subsample_pct': 0.02, 'verbose': 0}
Trying parameters: {'ig_improvement': 0.3, 'max_depth': 3, 'min_subset': 0.05, 'n_jobs': -1, 'n_max_dim': 0, 'n_trees': 10, 'subsample_pct': 0.02, 'verbose': 0}
Trying parameters: {'ig_improvement': 0.3, 'max_depth': 4, 'min_subset': 0.05, 'n_jobs': -1, 'n_max_dim': 0, 'n_trees': 10, 'subsample_pct': 0.02, 'verbose': 0}
Trying parameters: {'ig_improvement': 0.3, 'max_depth': 5, 'min_subset': 0.05, 'n_jobs': -1, 'n_max_dim': 0, 'n_trees': 10, 'subsample_pct': 0.02, 'verbose': 0}
Trying parameters: {'ig_improvement': 0.5, 'max_depth': 2, 'min_subset': 0.05, 'n_jobs': -1, 'n_max_dim': 0, 'n_trees': 10, 'subsample_pct': 0.02, 'verbose': 0}
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 13108410623461871100
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 10913290650
locality {
  bus_id: 1
  links {
  }
}
incarnation: 591436909397946548
physical_device_desc: "device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:02:00.0, compute capability: 6.1"
]
(array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9], dtype=uint8), array([5923, 6742, 5958, 6131, 5842, 5421, 5918, 6265, 5851, 5949]))
7
(array([0, 1, 2, 3, 4, 5, 6, 7, 8], dtype=uint8), array([5923, 6742, 5958, 6131, 5842, 5421, 5918, 5851, 5949]))
x_train shape: (53735, 28, 28, 1)
53735 train samples
8972 test samples
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_1 (Conv2D)            (None, 26, 26, 32)        320       
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 24, 24, 64)        18496     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 12, 12, 64)        0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 12, 12, 64)        0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 9216)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 128)               1179776   
_________________________________________________________________
dropout_2 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 9)                 1161      
=================================================================
Total params: 1,199,753
Trainable params: 1,199,753
Non-trainable params: 0
_________________________________________________________________
None
Train on 53735 samples, validate on 8972 samples
Epoch 1/5

  128/53735 [..............................] - ETA: 11:43 - loss: 2.1977 - acc: 0.1016
  896/53735 [..............................] - ETA: 1:42 - loss: 1.9761 - acc: 0.2846 
 1792/53735 [>.............................] - ETA: 51s - loss: 1.6758 - acc: 0.4146 
 2688/53735 [>.............................] - ETA: 35s - loss: 1.4350 - acc: 0.5015
 3584/53735 [=>............................] - ETA: 26s - loss: 1.2511 - acc: 0.5698
 4480/53735 [=>............................] - ETA: 21s - loss: 1.1166 - acc: 0.6188
 5376/53735 [==>...........................] - ETA: 18s - loss: 1.0011 - acc: 0.6609
 6272/53735 [==>...........................] - ETA: 15s - loss: 0.9005 - acc: 0.6960
 7168/53735 [===>..........................] - ETA: 13s - loss: 0.8306 - acc: 0.7204
 8064/53735 [===>..........................] - ETA: 12s - loss: 0.7741 - acc: 0.7417
 8960/53735 [====>.........................] - ETA: 11s - loss: 0.7230 - acc: 0.7589
 9856/53735 [====>.........................] - ETA: 10s - loss: 0.6851 - acc: 0.7729
10752/53735 [=====>........................] - ETA: 9s - loss: 0.6458 - acc: 0.7865 
11648/53735 [=====>........................] - ETA: 8s - loss: 0.6115 - acc: 0.7984
12544/53735 [======>.......................] - ETA: 7s - loss: 0.5815 - acc: 0.8085
13440/53735 [======>.......................] - ETA: 7s - loss: 0.5595 - acc: 0.8164
14336/53735 [=======>......................] - ETA: 6s - loss: 0.5393 - acc: 0.8238
15232/53735 [=======>......................] - ETA: 6s - loss: 0.5175 - acc: 0.8311
16128/53735 [========>.....................] - ETA: 6s - loss: 0.5010 - acc: 0.8369
17024/53735 [========>.....................] - ETA: 5s - loss: 0.4838 - acc: 0.8426
17920/53735 [=========>....................] - ETA: 5s - loss: 0.4666 - acc: 0.8485
18816/53735 [=========>....................] - ETA: 5s - loss: 0.4527 - acc: 0.8536
19712/53735 [==========>...................] - ETA: 4s - loss: 0.4405 - acc: 0.8578
20608/53735 [==========>...................] - ETA: 4s - loss: 0.4302 - acc: 0.8615
21504/53735 [===========>..................] - ETA: 4s - loss: 0.4190 - acc: 0.8649
22016/53735 [===========>..................] - ETA: 4s - loss: 0.4135 - acc: 0.8667
22400/53735 [===========>..................] - ETA: 4s - loss: 0.4092 - acc: 0.8681
23296/53735 [============>.................] - ETA: 4s - loss: 0.3982 - acc: 0.8718
24192/53735 [============>.................] - ETA: 3s - loss: 0.3890 - acc: 0.8749
25088/53735 [=============>................] - ETA: 3s - loss: 0.3809 - acc: 0.8778
25984/53735 [=============>................] - ETA: 3s - loss: 0.3719 - acc: 0.8808
27008/53735 [==============>...............] - ETA: 3s - loss: 0.3628 - acc: 0.8838
28032/53735 [==============>...............] - ETA: 3s - loss: 0.3541 - acc: 0.8867
29056/53735 [===============>..............] - ETA: 2s - loss: 0.3461 - acc: 0.8893
30080/53735 [===============>..............] - ETA: 2s - loss: 0.3379 - acc: 0.8919
30976/53735 [================>.............] - ETA: 2s - loss: 0.3320 - acc: 0.8937
31872/53735 [================>.............] - ETA: 2s - loss: 0.3264 - acc: 0.8954
32768/53735 [=================>............] - ETA: 2s - loss: 0.3204 - acc: 0.8972
33664/53735 [=================>............] - ETA: 2s - loss: 0.3156 - acc: 0.8989
34560/53735 [==================>...........] - ETA: 2s - loss: 0.3110 - acc: 0.9006
35456/53735 [==================>...........] - ETA: 1s - loss: 0.3065 - acc: 0.9021
36352/53735 [===================>..........] - ETA: 1s - loss: 0.3020 - acc: 0.9037
37248/53735 [===================>..........] - ETA: 1s - loss: 0.2973 - acc: 0.9053
38272/53735 [====================>.........] - ETA: 1s - loss: 0.2918 - acc: 0.9069
39296/53735 [====================>.........] - ETA: 1s - loss: 0.2872 - acc: 0.9084
40320/53735 [=====================>........] - ETA: 1s - loss: 0.2825 - acc: 0.9099
41216/53735 [======================>.......] - ETA: 1s - loss: 0.2782 - acc: 0.9113
42112/53735 [======================>.......] - ETA: 1s - loss: 0.2753 - acc: 0.9124
43136/53735 [=======================>......] - ETA: 1s - loss: 0.2713 - acc: 0.9136
44032/53735 [=======================>......] - ETA: 0s - loss: 0.2684 - acc: 0.9144
44928/53735 [========================>.....] - ETA: 0s - loss: 0.2653 - acc: 0.9155
45824/53735 [========================>.....] - ETA: 0s - loss: 0.2628 - acc: 0.9163
46720/53735 [=========================>....] - ETA: 0s - loss: 0.2600 - acc: 0.9172
47616/53735 [=========================>....] - ETA: 0s - loss: 0.2579 - acc: 0.9179
48512/53735 [==========================>...] - ETA: 0s - loss: 0.2552 - acc: 0.9189
49408/53735 [==========================>...] - ETA: 0s - loss: 0.2530 - acc: 0.9197
50304/53735 [===========================>..] - ETA: 0s - loss: 0.2506 - acc: 0.9205
51200/53735 [===========================>..] - ETA: 0s - loss: 0.2474 - acc: 0.9215
52096/53735 [============================>.] - ETA: 0s - loss: 0.2447 - acc: 0.9224
53120/53735 [============================>.] - ETA: 0s - loss: 0.2424 - acc: 0.9232
53735/53735 [==============================] - 5s 94us/step - loss: 0.2408 - acc: 0.9237 - val_loss: 0.0477 - val_acc: 0.9835
Epoch 2/5

  128/53735 [..............................] - ETA: 4s - loss: 0.1843 - acc: 0.9609
 1152/53735 [..............................] - ETA: 3s - loss: 0.0849 - acc: 0.9722
 2048/53735 [>.............................] - ETA: 2s - loss: 0.0853 - acc: 0.9727
 2944/53735 [>.............................] - ETA: 2s - loss: 0.0864 - acc: 0.9718
 3840/53735 [=>............................] - ETA: 2s - loss: 0.0836 - acc: 0.9729
 4736/53735 [=>............................] - ETA: 2s - loss: 0.0845 - acc: 0.9738
 5632/53735 [==>...........................] - ETA: 2s - loss: 0.0924 - acc: 0.9723
 6528/53735 [==>...........................] - ETA: 2s - loss: 0.0906 - acc: 0.9726
 7424/53735 [===>..........................] - ETA: 2s - loss: 0.0910 - acc: 0.9729
 8320/53735 [===>..........................] - ETA: 2s - loss: 0.0877 - acc: 0.9743
 9216/53735 [====>.........................] - ETA: 2s - loss: 0.0852 - acc: 0.9748
10112/53735 [====>.........................] - ETA: 2s - loss: 0.0830 - acc: 0.9752
11136/53735 [=====>........................] - ETA: 2s - loss: 0.0849 - acc: 0.9747
12160/53735 [=====>........................] - ETA: 2s - loss: 0.0849 - acc: 0.9744
13184/53735 [======>.......................] - ETA: 2s - loss: 0.0854 - acc: 0.9749
14208/53735 [======>.......................] - ETA: 2s - loss: 0.0841 - acc: 0.9752
15104/53735 [=======>......................] - ETA: 2s - loss: 0.0840 - acc: 0.9750
16000/53735 [=======>......................] - ETA: 2s - loss: 0.0847 - acc: 0.9749
16896/53735 [========>.....................] - ETA: 2s - loss: 0.0832 - acc: 0.9754
17792/53735 [========>.....................] - ETA: 2s - loss: 0.0820 - acc: 0.9757
18688/53735 [=========>....................] - ETA: 2s - loss: 0.0814 - acc: 0.9760
19584/53735 [=========>....................] - ETA: 1s - loss: 0.0805 - acc: 0.9764
20480/53735 [==========>...................] - ETA: 1s - loss: 0.0799 - acc: 0.9764
21248/53735 [==========>...................] - ETA: 1s - loss: 0.0797 - acc: 0.9761
22144/53735 [===========>..................] - ETA: 1s - loss: 0.0802 - acc: 0.9759
23040/53735 [===========>..................] - ETA: 1s - loss: 0.0795 - acc: 0.9762
23936/53735 [============>.................] - ETA: 1s - loss: 0.0798 - acc: 0.9760
24832/53735 [============>.................] - ETA: 1s - loss: 0.0790 - acc: 0.9762
25728/53735 [=============>................] - ETA: 1s - loss: 0.0791 - acc: 0.9764
26624/53735 [=============>................] - ETA: 1s - loss: 0.0797 - acc: 0.9762
27520/53735 [==============>...............] - ETA: 1s - loss: 0.0800 - acc: 0.9762
28416/53735 [==============>...............] - ETA: 1s - loss: 0.0797 - acc: 0.9763
29312/53735 [===============>..............] - ETA: 1s - loss: 0.0795 - acc: 0.9763
30208/53735 [===============>..............] - ETA: 1s - loss: 0.0793 - acc: 0.9763
31104/53735 [================>.............] - ETA: 1s - loss: 0.0789 - acc: 0.9765
32000/53735 [================>.............] - ETA: 1s - loss: 0.0784 - acc: 0.9766
32896/53735 [=================>............] - ETA: 1s - loss: 0.0783 - acc: 0.9765
33792/53735 [=================>............] - ETA: 1s - loss: 0.0784 - acc: 0.9764
34688/53735 [==================>...........] - ETA: 1s - loss: 0.0785 - acc: 0.9763
35584/53735 [==================>...........] - ETA: 1s - loss: 0.0784 - acc: 0.9764
36480/53735 [===================>..........] - ETA: 1s - loss: 0.0775 - acc: 0.9766
37376/53735 [===================>..........] - ETA: 0s - loss: 0.0775 - acc: 0.9767
38272/53735 [====================>.........] - ETA: 0s - loss: 0.0769 - acc: 0.9768
39296/53735 [====================>.........] - ETA: 0s - loss: 0.0765 - acc: 0.9769
40192/53735 [=====================>........] - ETA: 0s - loss: 0.0766 - acc: 0.9769
41216/53735 [======================>.......] - ETA: 0s - loss: 0.0759 - acc: 0.9770
42112/53735 [======================>.......] - ETA: 0s - loss: 0.0760 - acc: 0.9770
43136/53735 [=======================>......] - ETA: 0s - loss: 0.0758 - acc: 0.9772
44032/53735 [=======================>......] - ETA: 0s - loss: 0.0758 - acc: 0.9772
45056/53735 [========================>.....] - ETA: 0s - loss: 0.0760 - acc: 0.9770
45952/53735 [========================>.....] - ETA: 0s - loss: 0.0759 - acc: 0.9771
46848/53735 [=========================>....] - ETA: 0s - loss: 0.0761 - acc: 0.9771
47744/53735 [=========================>....] - ETA: 0s - loss: 0.0758 - acc: 0.9770
48640/53735 [==========================>...] - ETA: 0s - loss: 0.0757 - acc: 0.9770
49536/53735 [==========================>...] - ETA: 0s - loss: 0.0758 - acc: 0.9771
50432/53735 [===========================>..] - ETA: 0s - loss: 0.0756 - acc: 0.9771
51328/53735 [===========================>..] - ETA: 0s - loss: 0.0757 - acc: 0.9771
51584/53735 [===========================>..] - ETA: 0s - loss: 0.0756 - acc: 0.9771
52480/53735 [============================>.] - ETA: 0s - loss: 0.0754 - acc: 0.9772
53376/53735 [============================>.] - ETA: 0s - loss: 0.0753 - acc: 0.9771
53735/53735 [==============================] - 3s 62us/step - loss: 0.0751 - acc: 0.9771 - val_loss: 0.0332 - val_acc: 0.9891
Epoch 3/5

  128/53735 [..............................] - ETA: 4s - loss: 0.1124 - acc: 0.9766
 1024/53735 [..............................] - ETA: 3s - loss: 0.0634 - acc: 0.9795
 1920/53735 [>.............................] - ETA: 3s - loss: 0.0599 - acc: 0.9807
 2816/53735 [>.............................] - ETA: 3s - loss: 0.0559 - acc: 0.9826
 3712/53735 [=>............................] - ETA: 2s - loss: 0.0584 - acc: 0.9825
 4736/53735 [=>............................] - ETA: 2s - loss: 0.0583 - acc: 0.9818
 5760/53735 [==>...........................] - ETA: 2s - loss: 0.0612 - acc: 0.9819
 6528/53735 [==>...........................] - ETA: 2s - loss: 0.0593 - acc: 0.9828
 7424/53735 [===>..........................] - ETA: 2s - loss: 0.0573 - acc: 0.9836
 8320/53735 [===>..........................] - ETA: 2s - loss: 0.0585 - acc: 0.9828
 9216/53735 [====>.........................] - ETA: 2s - loss: 0.0573 - acc: 0.9829
10112/53735 [====>.........................] - ETA: 2s - loss: 0.0580 - acc: 0.9828
11008/53735 [=====>........................] - ETA: 2s - loss: 0.0576 - acc: 0.9828
11904/53735 [=====>........................] - ETA: 2s - loss: 0.0573 - acc: 0.9834
12800/53735 [======>.......................] - ETA: 2s - loss: 0.0578 - acc: 0.9830
13696/53735 [======>.......................] - ETA: 2s - loss: 0.0580 - acc: 0.9831
14592/53735 [=======>......................] - ETA: 2s - loss: 0.0575 - acc: 0.9834
15616/53735 [=======>......................] - ETA: 2s - loss: 0.0573 - acc: 0.9835
16512/53735 [========>.....................] - ETA: 2s - loss: 0.0576 - acc: 0.9835
17408/53735 [========>.....................] - ETA: 2s - loss: 0.0577 - acc: 0.9835
18304/53735 [=========>....................] - ETA: 2s - loss: 0.0582 - acc: 0.9833
19200/53735 [=========>....................] - ETA: 2s - loss: 0.0585 - acc: 0.9830
20096/53735 [==========>...................] - ETA: 1s - loss: 0.0578 - acc: 0.9833
20992/53735 [==========>...................] - ETA: 1s - loss: 0.0572 - acc: 0.9833
21888/53735 [===========>..................] - ETA: 1s - loss: 0.0575 - acc: 0.9831
22784/53735 [===========>..................] - ETA: 1s - loss: 0.0582 - acc: 0.9830
23680/53735 [============>.................] - ETA: 1s - loss: 0.0575 - acc: 0.9832
24576/53735 [============>.................] - ETA: 1s - loss: 0.0585 - acc: 0.9830
25472/53735 [=============>................] - ETA: 1s - loss: 0.0597 - acc: 0.9827
26368/53735 [=============>................] - ETA: 1s - loss: 0.0595 - acc: 0.9827
27264/53735 [==============>...............] - ETA: 1s - loss: 0.0592 - acc: 0.9828
28160/53735 [==============>...............] - ETA: 1s - loss: 0.0590 - acc: 0.9827
29056/53735 [===============>..............] - ETA: 1s - loss: 0.0589 - acc: 0.9829
29952/53735 [===============>..............] - ETA: 1s - loss: 0.0599 - acc: 0.9824
30848/53735 [================>.............] - ETA: 1s - loss: 0.0598 - acc: 0.9825
31744/53735 [================>.............] - ETA: 1s - loss: 0.0589 - acc: 0.9827
32512/53735 [=================>............] - ETA: 1s - loss: 0.0590 - acc: 0.9827
33408/53735 [=================>............] - ETA: 1s - loss: 0.0584 - acc: 0.9826
34304/53735 [==================>...........] - ETA: 1s - loss: 0.0581 - acc: 0.9828
35200/53735 [==================>...........] - ETA: 1s - loss: 0.0587 - acc: 0.9827
36096/53735 [===================>..........] - ETA: 1s - loss: 0.0585 - acc: 0.9828
36992/53735 [===================>..........] - ETA: 0s - loss: 0.0581 - acc: 0.9828
37888/53735 [====================>.........] - ETA: 0s - loss: 0.0586 - acc: 0.9826
38784/53735 [====================>.........] - ETA: 0s - loss: 0.0584 - acc: 0.9826
39680/53735 [=====================>........] - ETA: 0s - loss: 0.0581 - acc: 0.9827
40576/53735 [=====================>........] - ETA: 0s - loss: 0.0582 - acc: 0.9827
41472/53735 [======================>.......] - ETA: 0s - loss: 0.0578 - acc: 0.9828
42368/53735 [======================>.......] - ETA: 0s - loss: 0.0580 - acc: 0.9828
43264/53735 [=======================>......] - ETA: 0s - loss: 0.0579 - acc: 0.9829
44160/53735 [=======================>......] - ETA: 0s - loss: 0.0580 - acc: 0.9829
45056/53735 [========================>.....] - ETA: 0s - loss: 0.0576 - acc: 0.9830
45952/53735 [========================>.....] - ETA: 0s - loss: 0.0575 - acc: 0.9830
46848/53735 [=========================>....] - ETA: 0s - loss: 0.0576 - acc: 0.9829
47744/53735 [=========================>....] - ETA: 0s - loss: 0.0573 - acc: 0.9830
48640/53735 [==========================>...] - ETA: 0s - loss: 0.0572 - acc: 0.9830
49536/53735 [==========================>...] - ETA: 0s - loss: 0.0570 - acc: 0.9830
50432/53735 [===========================>..] - ETA: 0s - loss: 0.0573 - acc: 0.9829
51328/53735 [===========================>..] - ETA: 0s - loss: 0.0574 - acc: 0.9830
52224/53735 [============================>.] - ETA: 0s - loss: 0.0571 - acc: 0.9830
53120/53735 [============================>.] - ETA: 0s - loss: 0.0572 - acc: 0.9831
53735/53735 [==============================] - 3s 62us/step - loss: 0.0571 - acc: 0.9831 - val_loss: 0.0300 - val_acc: 0.9893
Epoch 4/5

  128/53735 [..............................] - ETA: 3s - loss: 0.0154 - acc: 0.9922
 1024/53735 [..............................] - ETA: 3s - loss: 0.0421 - acc: 0.9863
 2048/53735 [>.............................] - ETA: 2s - loss: 0.0392 - acc: 0.9878
 2944/53735 [>.............................] - ETA: 2s - loss: 0.0401 - acc: 0.9878
 3840/53735 [=>............................] - ETA: 2s - loss: 0.0425 - acc: 0.9875
 4736/53735 [=>............................] - ETA: 2s - loss: 0.0416 - acc: 0.9882
 5632/53735 [==>...........................] - ETA: 2s - loss: 0.0392 - acc: 0.9892
 6528/53735 [==>...........................] - ETA: 2s - loss: 0.0385 - acc: 0.9888
 7552/53735 [===>..........................] - ETA: 2s - loss: 0.0409 - acc: 0.9878
 8576/53735 [===>..........................] - ETA: 2s - loss: 0.0399 - acc: 0.9876
 9472/53735 [====>.........................] - ETA: 2s - loss: 0.0417 - acc: 0.9871
10496/53735 [====>.........................] - ETA: 2s - loss: 0.0407 - acc: 0.9875
11392/53735 [=====>........................] - ETA: 2s - loss: 0.0437 - acc: 0.9867
12288/53735 [=====>........................] - ETA: 2s - loss: 0.0433 - acc: 0.9868
13184/53735 [======>.......................] - ETA: 2s - loss: 0.0429 - acc: 0.9871
14080/53735 [======>.......................] - ETA: 2s - loss: 0.0436 - acc: 0.9871
14976/53735 [=======>......................] - ETA: 2s - loss: 0.0461 - acc: 0.9866
15872/53735 [=======>......................] - ETA: 2s - loss: 0.0470 - acc: 0.9864
16768/53735 [========>.....................] - ETA: 2s - loss: 0.0476 - acc: 0.9865
17664/53735 [========>.....................] - ETA: 2s - loss: 0.0475 - acc: 0.9863
18560/53735 [=========>....................] - ETA: 2s - loss: 0.0470 - acc: 0.9863
19584/53735 [=========>....................] - ETA: 1s - loss: 0.0475 - acc: 0.9859
20480/53735 [==========>...................] - ETA: 1s - loss: 0.0478 - acc: 0.9859
21376/53735 [==========>...................] - ETA: 1s - loss: 0.0478 - acc: 0.9858
22272/53735 [===========>..................] - ETA: 1s - loss: 0.0469 - acc: 0.9859
23296/53735 [============>.................] - ETA: 1s - loss: 0.0465 - acc: 0.9861
24320/53735 [============>.................] - ETA: 1s - loss: 0.0464 - acc: 0.9860
25216/53735 [=============>................] - ETA: 1s - loss: 0.0469 - acc: 0.9860
26112/53735 [=============>................] - ETA: 1s - loss: 0.0469 - acc: 0.9860
27008/53735 [==============>...............] - ETA: 1s - loss: 0.0467 - acc: 0.9860
27904/53735 [==============>...............] - ETA: 1s - loss: 0.0467 - acc: 0.9860
28928/53735 [===============>..............] - ETA: 1s - loss: 0.0467 - acc: 0.9859
29952/53735 [===============>..............] - ETA: 1s - loss: 0.0469 - acc: 0.9859
30848/53735 [================>.............] - ETA: 1s - loss: 0.0473 - acc: 0.9858
31744/53735 [================>.............] - ETA: 1s - loss: 0.0471 - acc: 0.9858
32640/53735 [=================>............] - ETA: 1s - loss: 0.0468 - acc: 0.9859
33536/53735 [=================>............] - ETA: 1s - loss: 0.0475 - acc: 0.9857
34432/53735 [==================>...........] - ETA: 1s - loss: 0.0470 - acc: 0.9858
35328/53735 [==================>...........] - ETA: 1s - loss: 0.0469 - acc: 0.9859
36224/53735 [===================>..........] - ETA: 1s - loss: 0.0469 - acc: 0.9859
37120/53735 [===================>..........] - ETA: 0s - loss: 0.0470 - acc: 0.9859
38016/53735 [====================>.........] - ETA: 0s - loss: 0.0468 - acc: 0.9861
38912/53735 [====================>.........] - ETA: 0s - loss: 0.0466 - acc: 0.9862
39808/53735 [=====================>........] - ETA: 0s - loss: 0.0466 - acc: 0.9862[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 10821263565995395895
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 10913290650
locality {
  bus_id: 1
  links {
  }
}
incarnation: 13155061270840939161
physical_device_desc: "device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:02:00.0, compute capability: 6.1"
]
(array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9], dtype=uint8), array([5923, 6742, 5958, 6131, 5842, 5421, 5918, 6265, 5851, 5949]))
8
(array([0, 1, 2, 3, 4, 5, 6, 7, 8], dtype=uint8), array([5923, 6742, 5958, 6131, 5842, 5421, 5918, 6265, 5949]))
x_train shape: (54149, 28, 28, 1)
54149 train samples
9026 test samples
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_1 (Conv2D)            (None, 26, 26, 32)        320       
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 24, 24, 64)        18496     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 12, 12, 64)        0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 12, 12, 64)        0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 9216)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 128)               1179776   
_________________________________________________________________
dropout_2 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 9)                 1161      
=================================================================
Total params: 1,199,753
Trainable params: 1,199,753
Non-trainable params: 0
_________________________________________________________________
None
Train on 54149 samples, validate on 9026 samples
Epoch 1/5

  128/54149 [..............................] - ETA: 9:19 - loss: 2.1896 - acc: 0.0547
 1024/54149 [..............................] - ETA: 1:11 - loss: 1.8510 - acc: 0.3447
 1920/54149 [>.............................] - ETA: 39s - loss: 1.5388 - acc: 0.4714 
 2816/54149 [>.............................] - ETA: 27s - loss: 1.2883 - acc: 0.5636
 3712/54149 [=>............................] - ETA: 20s - loss: 1.1562 - acc: 0.6107
 4608/54149 [=>............................] - ETA: 17s - loss: 1.0330 - acc: 0.6517
 5504/54149 [==>...........................] - ETA: 14s - loss: 0.9321 - acc: 0.6864
 6400/54149 [==>...........................] - ETA: 12s - loss: 0.8526 - acc: 0.7139
 7296/54149 [===>..........................] - ETA: 11s - loss: 0.7915 - acc: 0.7356
 8192/54149 [===>..........................] - ETA: 10s - loss: 0.7380 - acc: 0.7548
 9088/54149 [====>.........................] - ETA: 9s - loss: 0.6941 - acc: 0.7707 
 9984/54149 [====>.........................] - ETA: 8s - loss: 0.6574 - acc: 0.7831
10880/54149 [=====>........................] - ETA: 7s - loss: 0.6245 - acc: 0.7949
11904/54149 [=====>........................] - ETA: 7s - loss: 0.5927 - acc: 0.8069
12800/54149 [======>.......................] - ETA: 6s - loss: 0.5702 - acc: 0.8152
13696/54149 [======>.......................] - ETA: 6s - loss: 0.5479 - acc: 0.8232
14592/54149 [=======>......................] - ETA: 5s - loss: 0.5275 - acc: 0.8305
15360/54149 [=======>......................] - ETA: 5s - loss: 0.5115 - acc: 0.8355
16256/54149 [========>.....................] - ETA: 5s - loss: 0.4927 - acc: 0.8414
17152/54149 [========>.....................] - ETA: 4s - loss: 0.4755 - acc: 0.8473
18048/54149 [========>.....................] - ETA: 4s - loss: 0.4592 - acc: 0.8529
18944/54149 [=========>....................] - ETA: 4s - loss: 0.4461 - acc: 0.8575
19840/54149 [=========>....................] - ETA: 4s - loss: 0.4340 - acc: 0.8617
20736/54149 [==========>...................] - ETA: 4s - loss: 0.4221 - acc: 0.8655
21760/54149 [===========>..................] - ETA: 3s - loss: 0.4098 - acc: 0.8697
22656/54149 [===========>..................] - ETA: 3s - loss: 0.4020 - acc: 0.8724
23552/54149 [============>.................] - ETA: 3s - loss: 0.3922 - acc: 0.8755
24448/54149 [============>.................] - ETA: 3s - loss: 0.3830 - acc: 0.8784
25344/54149 [=============>................] - ETA: 3s - loss: 0.3743 - acc: 0.8811
26240/54149 [=============>................] - ETA: 3s - loss: 0.3663 - acc: 0.8837
27136/54149 [==============>...............] - ETA: 2s - loss: 0.3577 - acc: 0.8865
28032/54149 [==============>...............] - ETA: 2s - loss: 0.3504 - acc: 0.8888
28928/54149 [===============>..............] - ETA: 2s - loss: 0.3437 - acc: 0.8909
29824/54149 [===============>..............] - ETA: 2s - loss: 0.3363 - acc: 0.8933
30720/54149 [================>.............] - ETA: 2s - loss: 0.3305 - acc: 0.8951
31616/54149 [================>.............] - ETA: 2s - loss: 0.3246 - acc: 0.8969
32640/54149 [=================>............] - ETA: 2s - loss: 0.3180 - acc: 0.8990
33536/54149 [=================>............] - ETA: 2s - loss: 0.3135 - acc: 0.9003
34432/54149 [==================>...........] - ETA: 1s - loss: 0.3090 - acc: 0.9020
35328/54149 [==================>...........] - ETA: 1s - loss: 0.3048 - acc: 0.9034
36352/54149 [===================>..........] - ETA: 1s - loss: 0.2990 - acc: 0.9054
37376/54149 [===================>..........] - ETA: 1s - loss: 0.2937 - acc: 0.9071
38272/54149 [====================>.........] - ETA: 1s - loss: 0.2893 - acc: 0.9085
39168/54149 [====================>.........] - ETA: 1s - loss: 0.2858 - acc: 0.9099
40064/54149 [=====================>........] - ETA: 1s - loss: 0.2813 - acc: 0.9114
40960/54149 [=====================>........] - ETA: 1s - loss: 0.2777 - acc: 0.9127
41856/54149 [======================>.......] - ETA: 1s - loss: 0.2739 - acc: 0.9140
42880/54149 [======================>.......] - ETA: 0s - loss: 0.2701 - acc: 0.9152
43904/54149 [=======================>......] - ETA: 0s - loss: 0.2664 - acc: 0.9164
44928/54149 [=======================>......] - ETA: 0s - loss: 0.2632 - acc: 0.9174
45824/54149 [========================>.....] - ETA: 0s - loss: 0.2602 - acc: 0.9185
46848/54149 [========================>.....] - ETA: 0s - loss: 0.2567 - acc: 0.9195
47744/54149 [=========================>....] - ETA: 0s - loss: 0.2534 - acc: 0.9206
48640/54149 [=========================>....] - ETA: 0s - loss: 0.2504 - acc: 0.9216
49536/54149 [==========================>...] - ETA: 0s - loss: 0.2479 - acc: 0.9225
50432/54149 [==========================>...] - ETA: 0s - loss: 0.2450 - acc: 0.9235
51328/54149 [===========================>..] - ETA: 0s - loss: 0.2429 - acc: 0.9243
52352/54149 [============================>.] - ETA: 0s - loss: 0.2398 - acc: 0.9253
53376/54149 [============================>.] - ETA: 0s - loss: 0.2369 - acc: 0.9262
54149/54149 [==============================] - 5s 86us/step - loss: 0.2351 - acc: 0.9268 - val_loss: 0.0546 - val_acc: 0.9822
Epoch 2/5

  128/54149 [..............................] - ETA: 3s - loss: 0.1437 - acc: 0.9297
 1024/54149 [..............................] - ETA: 3s - loss: 0.0863 - acc: 0.9668
 2048/54149 [>.............................] - ETA: 2s - loss: 0.0886 - acc: 0.9727
 3072/54149 [>.............................] - ETA: 2s - loss: 0.0899 - acc: 0.9730
 4096/54149 [=>............................] - ETA: 2s - loss: 0.0921 - acc: 0.9727
 5120/54149 [=>............................] - ETA: 2s - loss: 0.0943 - acc: 0.9727
 6144/54149 [==>...........................] - ETA: 2s - loss: 0.0919 - acc: 0.9733
 7168/54149 [==>...........................] - ETA: 2s - loss: 0.0886 - acc: 0.9741
 8192/54149 [===>..........................] - ETA: 2s - loss: 0.0858 - acc: 0.9749
 9216/54149 [====>.........................] - ETA: 2s - loss: 0.0852 - acc: 0.9752
10240/54149 [====>.........................] - ETA: 2s - loss: 0.0859 - acc: 0.9756
11264/54149 [=====>........................] - ETA: 2s - loss: 0.0849 - acc: 0.9758
12288/54149 [=====>........................] - ETA: 2s - loss: 0.0843 - acc: 0.9757
13312/54149 [======>.......................] - ETA: 2s - loss: 0.0852 - acc: 0.9753
14336/54149 [======>.......................] - ETA: 2s - loss: 0.0854 - acc: 0.9756
15360/54149 [=======>......................] - ETA: 2s - loss: 0.0842 - acc: 0.9760
16384/54149 [========>.....................] - ETA: 2s - loss: 0.0848 - acc: 0.9760
17408/54149 [========>.....................] - ETA: 1s - loss: 0.0848 - acc: 0.9756
18432/54149 [=========>....................] - ETA: 1s - loss: 0.0845 - acc: 0.9754
19456/54149 [=========>....................] - ETA: 1s - loss: 0.0828 - acc: 0.9762
20480/54149 [==========>...................] - ETA: 1s - loss: 0.0841 - acc: 0.9758
21504/54149 [==========>...................] - ETA: 1s - loss: 0.0833 - acc: 0.9761
22528/54149 [===========>..................] - ETA: 1s - loss: 0.0833 - acc: 0.9761
23552/54149 [============>.................] - ETA: 1s - loss: 0.0825 - acc: 0.9763
24576/54149 [============>.................] - ETA: 1s - loss: 0.0818 - acc: 0.9764
25600/54149 [=============>................] - ETA: 1s - loss: 0.0813 - acc: 0.9764
26496/54149 [=============>................] - ETA: 1s - loss: 0.0812 - acc: 0.9764
27520/54149 [==============>...............] - ETA: 1s - loss: 0.0806 - acc: 0.9765
28416/54149 [==============>...............] - ETA: 1s - loss: 0.0811 - acc: 0.9764
29312/54149 [===============>..............] - ETA: 1s - loss: 0.0804 - acc: 0.9764
30336/54149 [===============>..............] - ETA: 1s - loss: 0.0801 - acc: 0.9763[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 679019534220766714
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 10913290650
locality {
  bus_id: 1
  links {
  }
}
incarnation: 5155068842543018775
physical_device_desc: "device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:02:00.0, compute capability: 6.1"
]
(array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9], dtype=uint8), array([5923, 6742, 5958, 6131, 5842, 5421, 5918, 6265, 5851, 5949]))
9
(array([0, 1, 2, 3, 4, 5, 6, 7, 8], dtype=uint8), array([5923, 6742, 5958, 6131, 5842, 5421, 5918, 6265, 5851]))
x_train shape: (54051, 28, 28, 1)
54051 train samples
8991 test samples
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_1 (Conv2D)            (None, 26, 26, 32)        320       
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 24, 24, 64)        18496     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 12, 12, 64)        0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 12, 12, 64)        0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 9216)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 128)               1179776   
_________________________________________________________________
dropout_2 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 9)                 1161      
=================================================================
Total params: 1,199,753
Trainable params: 1,199,753
Non-trainable params: 0
_________________________________________________________________
None
Train on 54051 samples, validate on 8991 samples
Epoch 1/5

  128/54051 [..............................] - ETA: 10:05 - loss: 2.2032 - acc: 0.0938
 1024/54051 [..............................] - ETA: 1:17 - loss: 1.8937 - acc: 0.3359 
 1920/54051 [>.............................] - ETA: 42s - loss: 1.5567 - acc: 0.4708 
 2816/54051 [>.............................] - ETA: 29s - loss: 1.2893 - acc: 0.5664
 3712/54051 [=>............................] - ETA: 22s - loss: 1.1355 - acc: 0.6245
 4608/54051 [=>............................] - ETA: 18s - loss: 1.0198 - acc: 0.6643
 5504/54051 [==>...........................] - ETA: 15s - loss: 0.9217 - acc: 0.6979
 6400/54051 [==>...........................] - ETA: 13s - loss: 0.8438 - acc: 0.7233
 7296/54051 [===>..........................] - ETA: 11s - loss: 0.7811 - acc: 0.7444
 8192/54051 [===>..........................] - ETA: 10s - loss: 0.7376 - acc: 0.7599
 9088/54051 [====>.........................] - ETA: 9s - loss: 0.6915 - acc: 0.7766 
10112/54051 [====>.........................] - ETA: 8s - loss: 0.6459 - acc: 0.7922
11136/54051 [=====>........................] - ETA: 7s - loss: 0.6061 - acc: 0.8061
12160/54051 [=====>........................] - ETA: 7s - loss: 0.5746 - acc: 0.8167
13184/54051 [======>.......................] - ETA: 6s - loss: 0.5476 - acc: 0.8262
14208/54051 [======>.......................] - ETA: 6s - loss: 0.5270 - acc: 0.8338
15232/54051 [=======>......................] - ETA: 5s - loss: 0.5028 - acc: 0.8420
16256/54051 [========>.....................] - ETA: 5s - loss: 0.4829 - acc: 0.8484
17280/54051 [========>.....................] - ETA: 5s - loss: 0.4654 - acc: 0.8546
18176/54051 [=========>....................] - ETA: 4s - loss: 0.4512 - acc: 0.8592
19200/54051 [=========>....................] - ETA: 4s - loss: 0.4357 - acc: 0.8641
20096/54051 [==========>...................] - ETA: 4s - loss: 0.4243 - acc: 0.8679
20992/54051 [==========>...................] - ETA: 4s - loss: 0.4131 - acc: 0.8716
21888/54051 [===========>..................] - ETA: 3s - loss: 0.4018 - acc: 0.8754